 * Serving Flask app 'teaching_api_zh'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8892
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 850-878-657
127.0.0.1 - - [25/Jun/2024 23:00:55] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [25/Jun/2024 23:01:05] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [25/Jun/2024 23:04:05] "POST /load HTTP/1.1" 200 -

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

127.0.0.1 - - [26/Jun/2024 08:04:51] "POST /load HTTP/1.1" 200 -
/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
127.0.0.1 - - [26/Jun/2024 08:05:00] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 15:32:36] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 15:32:44] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 15:32:52] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 16:26:18] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 16:26:27] "POST /chat HTTP/1.1" 200 -
2024-06-26 19:09:01.781 Session with id 415a3b3a-2ff7-40ff-8ef1-c80736d3b4cc is already connected! Connecting to a new session.
127.0.0.1 - - [26/Jun/2024 21:46:34] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 21:47:06] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 21:47:51] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 21:48:53] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 21:49:13] "POST /chat HTTP/1.1" 200 -
student_id : 1234lmj output 我的名字是柳某
未找到文件名为 我的名字是柳某.mp3 的MP3文件。
无重复
student_id : 1234lmj output 我没有食物方面的过敏反应。
未找到文件名为 我没有食物方面的过敏反应。.mp3 的MP3文件。
无重复
student_id : 1234lmj output 我对磺胺类药物有过敏反应。
未找到文件名为 我对磺胺类药物有过敏反应。.mp3 的MP3文件。
无重复
student_id : uiuio output 我的名字是柳某
有重复
student_id : 1 output 我没有食物方面的过敏反应。
有重复
student_id : 1 output 我对磺胺类药物有过敏反应。
有重复
  Stopping...

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

127.0.0.1 - - [26/Jun/2024 22:22:30] "POST /load HTTP/1.1" 200 -
/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
127.0.0.1 - - [26/Jun/2024 22:22:39] "POST /chat HTTP/1.1" 200 -
2024-06-26 22:22:43.575 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 571, in <module>
    detail_retrieval(st.session_state.state_goal,st.session_state.option)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 328, in detail_retrieval
    df = pd.read_excel('../knowledge_excel/'+option+'.xlsx')
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 1550, in __init__
    ext = inspect_excel_format(
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 1402, in inspect_excel_format
    with get_handle(
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: '../knowledge_excel/modified_7_急性原发性闭角型青光眼_1.xlsx'
127.0.0.1 - - [26/Jun/2024 22:28:54] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 22:29:03] "POST /chat HTTP/1.1" 200 -
2024-06-26 22:29:06.163 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 571, in <module>
    detail_retrieval(st.session_state.state_goal,st.session_state.option)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 328, in detail_retrieval
    df = pd.read_excel('../knowledge_excel/'+option+'.xlsx')
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 1550, in __init__
    ext = inspect_excel_format(
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 1402, in inspect_excel_format
    with get_handle(
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: '../knowledge_excel/modified_7_急性原发性闭角型青光眼_1.xlsx'
127.0.0.1 - - [26/Jun/2024 22:33:00] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 22:33:10] "POST /chat HTTP/1.1" 200 -
2024-06-26 22:33:15.684 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/root/miniconda3/envs/embedding/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1004, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 571, in <module>
    detail_retrieval(st.session_state.state_goal,st.session_state.option)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 328, in detail_retrieval
    df = pd.read_excel('../knowledge_excel/'+option+'.xlsx')
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
127.0.0.1 - - [26/Jun/2024 22:34:12] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 22:36:08] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 22:42:15] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [26/Jun/2024 22:42:21] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:00:39] "POST /load HTTP/1.1" 200 -
2024-07-11 10:00:54.518 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
127.0.0.1 - - [11/Jul/2024 10:01:36] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:15:15] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:16:19] "POST /chat HTTP/1.1" 200 -
2024-07-11 10:16:19.382 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 534, in <module>
    tts.save("../audio/%s.mp3"%output_audio)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/gtts/tts.py", line 334, in save
    with open(str(savefile), "wb") as f:
FileNotFoundError: [Errno 2] No such file or directory: '../audio/tml lang=en>\n<title>500 Internal Server Error</tit.mp3'
127.0.0.1 - - [11/Jul/2024 10:17:29] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:17:45] "POST /chat HTTP/1.1" 200 -
2024-07-11 10:17:45.501 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 534, in <module>
    tts.save("../audio/%s.mp3"%output_audio)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/gtts/tts.py", line 334, in save
    with open(str(savefile), "wb") as f:
FileNotFoundError: [Errno 2] No such file or directory: '../audio/tml lang=en>\n<title>500 Internal Server Error</tit.mp3'
127.0.0.1 - - [11/Jul/2024 10:18:20] "POST /load HTTP/1.1" 200 -
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 12315 user input: 你的名字是
----------------ChatZOC database log ----------------

distsnce: [0.21961066126823425, 0.321754515171051, 0.3251340985298157] 

知识库所有match: ['您的姓名是？', '您叫什么名字？', '您的名字是什么？']


知识库选择: 冯某某
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 1234lmj user input: 你好你叫做什么名字？
----------------ChatZOC database log ----------------

distsnce: [0.08612584322690964, 0.16021937131881714, 0.2969987392425537] 

知识库所有match: ['您叫什么名字？', '您的名字是什么？', '您的姓名是？']


知识库选择: 柳某
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 1234lmj user input: 你有没有食物过敏
----------------ChatZOC database log ----------------

distsnce: [0.17572246491909027, 0.3630138039588928, 0.39650672674179077] 

知识库所有match: ['你之前有没有食物过敏？', '您之前是否有食物过敏的情况？', '你之前有没有药物过敏？']


知识库选择: 没有食物过敏
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1234lmj user input: 你有没有药物过敏
----------------ChatZOC database log ----------------

distsnce: [0.1789541244506836, 0.36856570839881897, 0.3819444477558136] 

知识库所有match: ['你之前有没有药物过敏？', '您之前是否有药物过敏的情况？', '你之前有没有食物过敏？']


知识库选择: 我对磺胺类的药物过敏
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: uiuio user input: 你的名字
----------------ChatZOC database log ----------------

distsnce: [0.24164295196533203, 0.2790876030921936, 0.3054617941379547] 

知识库所有match: ['您的姓名是？', '您叫什么名字？', '您的名字是什么？']


知识库选择: 柳某
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 1 user input: 你有没有食物过敏
----------------ChatZOC database log ----------------

distsnce: [0.17572246491909027, 0.3630138039588928, 0.39650672674179077] 

知识库所有match: ['你之前有没有食物过敏？', '您之前是否有食物过敏的情况？', '你之前有没有药物过敏？']


知识库选择: 没有食物过敏
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1 user input: 你有没有药物过敏
----------------ChatZOC database log ----------------

distsnce: [0.1789541244506836, 0.36856570839881897, 0.3819444477558136] 

知识库所有match: ['你之前有没有药物过敏？', '您之前是否有药物过敏的情况？', '你之前有没有食物过敏？']


知识库选择: 我对磺胺类的药物过敏
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 12415 user input: 你的名字
----------------ChatZOC database log ----------------

distsnce: [0.24164295196533203, 0.2790876030921936, 0.3054617941379547] 

知识库所有match: ['您的姓名是？', '您叫什么名字？', '您的名字是什么？']


知识库选择: 柳某
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 980 user input: 你的名字
----------------ChatZOC database log ----------------

distsnce: [0.24164295196533203, 0.2790876030921936, 0.3054617941379547] 

知识库所有match: ['您的姓名是？', '您叫什么名字？', '您的名字是什么？']


知识库选择: 柳某
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 1251 user input: 你多少岁
----------------ChatZOC database log ----------------

distsnce: [0.20692339539527893, 0.23694917559623718, 0.2518395483493805] 

知识库所有match: ['您的年龄是多少岁？', '你今年是多少岁？', '您目前几岁了？']


知识库选择: 我今年74岁
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: kl user input: 你多少岁了
----------------ChatZOC database log ----------------

distsnce: [0.2189500629901886, 0.2223111093044281, 0.23545736074447632] 

知识库所有match: ['您目前几岁了？', '您的年龄是多少岁？', '你今年是多少岁？']


知识库选择: 我今年74岁
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 12e user input: 你的名字
----------------ChatZOC database log ----------------

distsnce: [0.24164295196533203, 0.2790876030921936, 0.3054617941379547] 

知识库所有match: ['您的姓名是？', '您叫什么名字？', '您的名字是什么？']


知识库选择: 柳某
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 1234 user input: 喂，喂喂，你好，你好，咋回事儿呢？啊，怎么回事儿哇？
------------ chatZOC api called -------------------------

student_id: 1234 user input: 你眼睛怎么不舒服呀？
----------------ChatZOC database log ----------------

distsnce: [0.12852701544761658, 0.15097558498382568, 0.24705171585083008] 

知识库所有match: ['您眼睛有什么不舒服？', '您眼睛是什么地方不舒服？', '您眼睛有什么不适感？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 1234 user input: 你眼睛怎么不舒服呀？
----------------ChatZOC database log ----------------

distsnce: [0.12852701544761658, 0.15097558498382568, 0.24705171585083008] 

知识库所有match: ['您眼睛有什么不舒服？', '您眼睛是什么地方不舒服？', '您眼睛有什么不适感？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 2345 user input: 你眼睛怎么不舒服呀？
127.0.0.1 - - [11/Jul/2024 10:18:31] "POST /chat HTTP/1.1" 200 -
2024-07-11 10:18:31.455 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 534, in <module>
    tts.save("../audio/%s.mp3"%output_audio)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/gtts/tts.py", line 334, in save
    with open(str(savefile), "wb") as f:
FileNotFoundError: [Errno 2] No such file or directory: '../audio/tml lang=en>\n<title>500 Internal Server Error</tit.mp3'
127.0.0.1 - - [11/Jul/2024 10:24:14] "POST /chat HTTP/1.1" 200 -
2024-07-11 10:24:14.169 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 534, in <module>
    tts.save("../audio/%s.mp3"%output_audio)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/gtts/tts.py", line 334, in save
    with open(str(savefile), "wb") as f:
FileNotFoundError: [Errno 2] No such file or directory: '../audio/tml lang=en>\n<title>500 Internal Server Error</tit.mp3'
2024-07-11 10:26:04.681 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-11 10:26:17.446 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
127.0.0.1 - - [11/Jul/2024 10:27:58] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:28:25] "POST /chat HTTP/1.1" 200 -
2024-07-11 10:28:25.682 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 534, in <module>
    tts.save("../audio/%s.mp3"%output_audio)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/gtts/tts.py", line 334, in save
    with open(str(savefile), "wb") as f:
FileNotFoundError: [Errno 2] No such file or directory: '../audio/tml lang=en>\n<title>500 Internal Server Error</tit.mp3'
127.0.0.1 - - [11/Jul/2024 10:30:06] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:30:15] "POST /chat HTTP/1.1" 200 -
2024-07-11 10:30:15.440 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 534, in <module>
    tts.save("../audio/%s.mp3"%output_audio)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/gtts/tts.py", line 334, in save
    with open(str(savefile), "wb") as f:
FileNotFoundError: [Errno 2] No such file or directory: '../audio/tml lang=en>\n<title>500 Internal Server Error</tit.mp3'
127.0.0.1 - - [11/Jul/2024 10:30:33] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:30:45] "POST /chat HTTP/1.1" 200 -
2024-07-11 10:30:45.487 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 534, in <module>
    tts.save("../audio/%s.mp3"%output_audio)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/gtts/tts.py", line 334, in save
    with open(str(savefile), "wb") as f:
FileNotFoundError: [Errno 2] No such file or directory: '../audio/tml lang=en>\n<title>500 Internal Server Error</tit.mp3'
127.0.0.1 - - [11/Jul/2024 10:34:48] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:35:01] "POST /chat HTTP/1.1" 200 -
2024-07-11 10:35:01.899 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 534, in <module>
    tts.save("../audio/%s.mp3"%output_audio)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/gtts/tts.py", line 334, in save
    with open(str(savefile), "wb") as f:
FileNotFoundError: [Errno 2] No such file or directory: '../audio/tml lang=en>\n<title>500 Internal Server Error</tit.mp3'
2024-07-11 10:37:09.967 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-11 10:37:14.367 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
127.0.0.1 - - [11/Jul/2024 10:38:41] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:39:10] "POST /chat HTTP/1.1" 200 -
2024-07-11 10:39:10.871 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 534, in <module>
    tts.save("../audio/%s.mp3"%output_audio)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/gtts/tts.py", line 334, in save
    with open(str(savefile), "wb") as f:
FileNotFoundError: [Errno 2] No such file or directory: '../audio/tml lang=en>\n<title>500 Internal Server Error</tit.mp3'
2024-07-11 10:40:00.784 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-11 10:40:08.790 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-11 10:40:25.385 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
127.0.0.1 - - [11/Jul/2024 10:43:43] "POST /load HTTP/1.1" 200 -
2024-07-11 10:44:05.799 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-11 10:44:08.684 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
127.0.0.1 - - [11/Jul/2024 10:45:01] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:46:32] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:48:31] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 10:48:40] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 11:19:03] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 11:20:03] "POST /chat HTTP/1.1" 200 -
student_id : 12415 output 我的名字是柳某
有重复
student_id : 980 output 我的名字是柳某
有重复
student_id : 1251 output 我今年七十四岁。
未找到文件名为 我今年七十四岁。.mp3 的MP3文件。
无重复
student_id : kl output 我今年七十四岁。
有重复
[1, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
12
眼别
13
时间
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
28
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
44
/
set null
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 57, 58, 59, 63, 66, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
57
治疗方案
58
治疗效果
59
疾病本身
63
疾病本身
66
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 83, 84, 85] <class 'list'>
82
set null
/
set null
83
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
[92, 93] <class 'list'>
92
set null
/
set null
93
set null
/
set null
student_id : 12e output 我的名字是柳某
有重复
[2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
12
眼别
13
时间
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
28
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
44
/
set null
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 57, 58, 59, 63, 66, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
57
治疗方案
58
治疗效果
59
疾病本身
63
疾病本身
66
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 83, 84, 85] <class 'list'>
82
set null
/
set null
83
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
[92, 93] <class 'list'>
92
set null
/
set null
93
set null
/
set null
student_id : 1234 output 我现在不想回答眼病无关的问题
未找到文件名为 我现在不想回答眼病无关的问题.mp3 的MP3文件。
无重复
time pass: 830 <class 'int'>
time pass: 830 <class 'int'>
student_id : 1234 output tml lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p
未找到文件名为 tml lang=en>
<title>500 Internal Server Error</tit.mp3 的MP3文件。
无重复
student_id : 1234 output tml lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p
未找到文件名为 tml lang=en>
<title>500 Internal Server Error</tit.mp3 的MP3文件。
无重复
student_id : 2345 output tml lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p
未找到文件名为 tml lang=en>
<title>500 Internal Server Error</tit.mp3 的MP3文件。
无重复
student_id : 2345 output tml lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p
未找到文件名为 tml lang=en>
<title>500 Internal Server Error</tit.mp3 的MP3文件。
无重复
student_id : 4455 output tml lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p
未找到文件名为 tml lang=en>
<title>500 Internal Server Error</tit.mp3 的MP3文件。
无重复
student_id : q output tml lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p
未找到文件名为 tml lang=en>
<title>500 Internal Server Error</tit.mp3 的MP3文件。
无重复
student_id : r output tml lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p
未找到文件名为 tml lang=en>
<title>500 Internal Server Error</tit.mp3 的MP3文件。
无重复
student_id : 980 output tml lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p
未找到文件名为 tml lang=en>
<title>500 Internal Server Error</tit.mp3 的MP3文件。
无重复
student_id : q output tml lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p
未找到文件名为 tml lang=en>
<title>500 Internal Server Error</tit.mp3 的MP3文件。
无重复
student_id : ljlj output 我是从事办公室工作的。
未找到文件名为 我是从事办公室工作的。.mp3 的MP3文件。
无重复
student_id : ljlj output 我是从事办公室工作的。
有重复
time pass: 307 <class 'int'>
time pass: 788 <class 'int'>
student_id : 1234 output 我平时需要化妆上班，但晚上我会有卸妆的习惯，不确定这和我的眼睛不适是否有关联。
未找到文件名为 我平时需要化妆上班，但晚上我会有卸妆的习惯，不确定这和我的眼睛不适是否有关联。.mp3 的MP3文件。
无重复
time pass: 1961 <class 'int'>
time pass: 1961 <class 'int'>
time pass: 1961 <class 'int'>
student_id : 1234 output 127.0.0.1 - - [11/Jul/2024 11:23:44] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [11/Jul/2024 11:24:40] "POST /chat HTTP/1.1" 200 -
2024-07-11 22:34:44.255 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
127.0.0.1 - - [12/Jul/2024 21:47:20] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [12/Jul/2024 21:47:27] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Jul/2024 21:48:06] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Jul/2024 21:48:31] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Jul/2024 21:49:38] "POST /chat HTTP/1.1" 200 -
----------------ChatZOC database log ----------------

distsnce: [0.11636285483837128, 0.12852701544761658, 0.12931793928146362] 

知识库所有match: ['你眼睛哪里不舒服？', '您眼睛有什么不舒服？', '你的眼睛为什么不舒服？']


知识库选择: 我的眼皮肿了，压一下还会痛
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 2345 user input: 你眼睛怎么不舒服呀？
----------------ChatZOC database log ----------------

distsnce: [0.11636285483837128, 0.12852701544761658, 0.12931793928146362] 

知识库所有match: ['你眼睛哪里不舒服？', '您眼睛有什么不舒服？', '你的眼睛为什么不舒服？']


知识库选择: 我的眼皮肿了，压一下还会痛
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 4455 user input: 你的眼睛怎么不舒服？
----------------ChatZOC database log ----------------

distsnce: [0.10287731885910034, 0.10467357933521271, 0.10583976656198502] 

知识库所有match: ['你的眼睛为什么不舒服？', '您眼睛有什么不舒服？', '你眼睛哪里不舒服？']


知识库选择: 我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: q user input: 你的眼睛怎么不舒服？
----------------ChatZOC database log ----------------

distsnce: [0.10467357933521271, 0.12790368497371674, 0.2083401381969452] 

知识库所有match: ['您眼睛有什么不舒服？', '您眼睛是什么地方不舒服？', '您眼睛有什么不适感？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: r user input: 你的眼睛怎么不舒服？
----------------ChatZOC database log ----------------

distsnce: [0.10467357933521271, 0.12790368497371674, 0.2083401381969452] 

知识库所有match: ['您眼睛有什么不舒服？', '您眼睛是什么地方不舒服？', '您眼睛有什么不适感？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 980 user input: 你的职业是
----------------ChatZOC database log ----------------

distsnce: [0.328838974237442, 0.5968536734580994, 0.7219368815422058] 

知识库所有match: ['您的职业是什么？', '你的工作是什么？', '你的学历是什么？']


知识库选择: 我已经退休了
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: q user input: 你的眼睛怎么不舒服？
----------------ChatZOC database log ----------------

distsnce: [0.10287731885910034, 0.10467357933521271, 0.10583976656198502] 

知识库所有match: ['你的眼睛为什么不舒服？', '您眼睛有什么不舒服？', '你眼睛哪里不舒服？']


知识库选择: 我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: ljlj user input: 你的职业是
----------------ChatZOC database log ----------------

distsnce: [0.328838974237442, 0.5968536734580994, 0.7219368815422058] 

知识库所有match: ['您的职业是什么？', '你的工作是什么？', '你的学历是什么？']


知识库选择: 我是办公室职员
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: ljlj user input: 你的职业是
----------------ChatZOC database log ----------------

distsnce: [0.328838974237442, 0.5968536734580994, 0.7219368815422058] 

知识库所有match: ['您的职业是什么？', '你的工作是什么？', '你的学历是什么？']


知识库选择: 我是办公室职员
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1234 user input: 他你眼睛怎么不舒服呀？
----------------ChatZOC database log ----------------

distsnce: [0.27581843733787537, 0.28557538986206055, 0.294803261756897] 

知识库所有match: ['你的眼睛为什么不舒服？', '您眼睛有什么不舒服？', '你眼睛哪里不舒服？']


知识库选择: 我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1234 user input: 你眼睛有什么不舒服的呀？
----------------ChatZOC database log ----------------

distsnce: [0.02002442069351673, 0.10737431049346924, 0.11170851439237595] 

知识库所有match: ['您眼睛有什么不舒服？', '你眼睛哪里不舒服？', '您眼睛以前有什么不舒服吗？']


知识库选择: 我的眼皮肿了，压一下还会痛
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1234 user input: 哪只眼睛不舒服？
----------------ChatZOC database log ----------------

distsnce: [0.13458116352558136, 0.15363536775112152, 0.18977151811122894] 

知识库所有match: ['你眼睛哪里不舒服？', '您眼睛是哪里不舒服？', '您眼睛有什么不舒服？']


知识库选择: 我的眼皮肿了，压一下还会痛
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1234 user input: 多久了？
----------------ChatZOC database log ----------------

distsnce: [0.02597859501838684, 0.16379094123840332, 0.377845823764801] 

知识库所有match: ['有多久了？', '多长时间了？', '这个情况持续了多久？']


知识库选择: 眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 1 user input: 今天天气怎么样
------------ chatZOC api called -------------------------

student_id: 1 user input: 你今天吃了什么
prev_flag: -1 <class 'int'> <class 'int'>
------------ chatZOC api called -------------------------

student_id: 1 user input: 你的眼睛干吗
----------------ChatZOC database log ----------------

distsnce: [0.025975126773118973, 0.28832393884658813, 0.3285323679447174] 

知识库所有match: ['你的眼睛干吗？', '您是否觉得眼睛干涩？', '你的眼睛痒吗？']


知识库选择: 我眼睛没有干涩
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1 user input: 红肿的地方皮肤会发热吗？
prev_flag: 2 <class 'int'> <class 'int'>
------------ chatZOC api called -------------------------

student_id: 1 user input: 平时有吃降血糖的药吗？
----------------ChatZOC database log ----------------

distsnce: 127.0.0.1 - - [12/Jul/2024 21:49:59] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Jul/2024 21:50:19] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Jul/2024 21:50:28] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Jul/2024 21:50:34] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Jul/2024 21:51:15] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Jul/2024 21:51:34] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [12/Jul/2024 21:52:11] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 16:25:13] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 16:31:08] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 16:31:32] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 16:31:42] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 16:31:55] "POST /chat HTTP/1.1" 200 -
[0.55803382396698, 0.5629685521125793, 0.5678055286407471] 

知识库所有match: ['您平时是否在服用降压药？', '吃降压药后血压怎么样？', '您是否定期服用药物来控制血压？']


知识库选择: 我平时会按时吃药控制血压
血压控制得还不错
我平时会按时吃药控制血压
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我平时会按时吃药控制血压
血压控制得还不错
我平时会按时吃药控制血压

#医生问题#
平时有吃降血糖的药吗？
response: 我没有提到吃降血糖的药。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我平时会按时吃药控制血压
血压控制得还不错
我平时会按时吃药控制血压

#医生问题#
平时有吃降血糖的药吗？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 1 user input: 肿物有破溃吗？
----------------ChatZOC database log ----------------

distsnce: [0.6182187795639038, 0.6609818935394287, 0.6672379970550537] 

知识库所有match: ['您是否患有甲亢？', '您是否患有传染性疾病？', '疼痛有诱因吗']


知识库选择: 我的甲状腺功能是正常的
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的甲状腺功能是正常的

#医生问题#
肿物有破溃吗？
response: 我不知道。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的甲状腺功能是正常的

#医生问题#
肿物有破溃吗？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 1 user input: 请问黑影是在哪个方向呢？
------------ chatZOC api called -------------------------

student_id: 1 user input: 请问你有闪光感吗？
----------------ChatZOC database log ----------------

distsnce: [1.5991076735347165e-13, 0.07401912659406662, 0.49018338322639465] 

知识库所有match: ['请问你有闪光感吗？', '请问你看东西有闪光感吗？', '请问你看东西的时候会不会突然有看到闪电一样的感觉？']


知识库选择: 没有
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1 user input: 你有发烧 吗
----------------ChatZOC database log ----------------

distsnce: [0.30257830023765564, 0.4406580924987793, 0.5203580260276794] 

知识库所有match: ['您有没有发烧的症状？', '你得过性病吗？', '您是否患有传染性疾病？']


知识库选择: 我没有发烧
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1 user input: 你有没有发烧？
----------------ChatZOC database log ----------------

distsnce: [0.13695116341114044, 0.44644567370414734, 0.562517523765564] 

知识库所有match: ['您有没有发烧的症状？', '您有没有出现发热的情况？', '您还有别的全身病吗？']


知识库选择: 我没有发烧
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1 user input: 你有手麻吗
----------------ChatZOC database log ----------------

distsnce: [0.6085166335105896, 0.6434484720230103, 0.6654853820800781] 

知识库所有match: ['你得过性病吗？', '你有自己吃药吗？', '您是否患有甲亢？']


知识库选择: 没有
我没有去医院看过，也没有用过眼药水
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有
我没有去医院看过，也没有用过眼药水

#医生问题#
你有手麻吗
response: 我没有手麻的症状。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有
我没有去医院看过，也没有用过眼药水

#医生问题#
你有手麻吗

**************FINISHED*****************



../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 12345 user input: 请问您眼睛有什么不舒服
----------------ChatZOC database log ----------------

distsnce: [0.09280930459499359, 0.15453827381134033, 0.22003641724586487] 

知识库所有match: ['您眼睛有什么不舒服？', '您眼睛是什么地方不舒服？', '您眼睛有什么不适感？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 12345 user input: 哪只眼睛？
----------------ChatZOC database log ----------------

distsnce: [0.02595514804124832, 0.11448995769023895, 0.23019298911094666] 

知识库所有match: ['是哪只眼睛？', '哪边的眼睛？', '是哪只眼睛看不清？']


知识库选择: 是左眼不舒服
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 12345 user input: 多久了
----------------ChatZOC database log ----------------

distsnce: [0.2076963633298874, 0.32846739888191223, 0.5490462779998779] 

知识库所有match: ['有多久了？', '多长时间了？', '这个情况持续了多久？']


知识库选择: 昨天开始的
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 12345 user input: 有没有用药
----------------ChatZOC database log ----------------

distsnce: [0.24826548993587494, 0.4935149550437927, 0.49518269300460815] 

知识库所有match: ['有没有用过什么药呀？', '有服用过什么药物吗', '有用过什么药物？']


知识库选择: 我没有去医院看过，也没有用过眼药水
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 12345 user input: 现在症状有改变吗
----------------ChatZOC database log ----------------

distsnce: [0.5065656304359436, 0.6292215585708618, 0.6515743732452393] 

知识库所有match: ['发病以来体重有变化吗？', '症状出现后您的情绪和精神状态有何变化？', '症状出现后您的饮食有何变化？']


知识库选择: 体重没有明显变化
精神不太好
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
体重没有明显变化
精神不太好

#医生问题#
现在症状有改变吗
response: 现在的精神状态还是没有明显改善，其他方面我没有感觉到明显的变化。
127.0.0.1 - - [15/Jul/2024 16:32:06] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 16:42:15] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 16:42:30] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 16:42:40] "POST /chat HTTP/1.1" 200 -
2024-07-15 16:59:07.799 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 16:59:10.827 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
127.0.0.1 - - [15/Jul/2024 18:07:03] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 18:07:11] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 18:07:15] "POST /chat HTTP/1.1" 200 -
我的眼皮肿胀并且按压时感到疼痛。
未找到文件名为 我的眼皮肿胀并且按压时感到疼痛。.mp3 的MP3文件。
无重复
student_id : 1234 output 的内容。\n我的眼皮感到肿胀，按压时会有疼痛感。
未找到文件名为 的内容。\n我的眼皮感到肿胀，按压时会有疼痛感。.mp3 的MP3文件。
无重复
student_id : 1234 output 我从三天前开始眼皮红肿并感到疼痛，昨天眼皮上出现了小白点，而今天情况变得更加严重了。
未找到文件名为 我从三天前开始眼皮红肿并感到疼痛，昨天眼皮上出现了小白点，而今天情况变得更加严重了。.mp3 的MP3文件。
无重复
student_id : 1 output 问题请集中在我眼病上
未找到文件名为 问题请集中在我眼病上.mp3 的MP3文件。
无重复
student_id : 1 output 能问详细点吗？具体是？
未找到文件名为 能问详细点吗？具体是？.mp3 的MP3文件。
无重复
student_id : 1 output 我的眼睛不觉得干涩。
未找到文件名为 我的眼睛不觉得干涩。.mp3 的MP3文件。
无重复
student_id : 1 output 能问详细点吗？具体是？
有重复
student_id : 1 output 我没有提到吃降血糖的药。
未找到文件名为 我没有提到吃降血糖的药。.mp3 的MP3文件。
无重复
student_id : 1 output 我不知道。
未找到文件名为 我不知道。.mp3 的MP3文件。
无重复
student_id : 1 output 问题请集中在我眼病上
有重复
student_id : 1 output 我没有闪光的感觉。
未找到文件名为 我没有闪光的感觉。.mp3 的MP3文件。
无重复
student_id : 1 output 我没有发烧的症状。 \n\n或者\n\n我没有发热。
未找到文件名为 我没有发烧的症状。 \n\n或者\n\n我没有发热。.mp3 的MP3文件。
无重复
student_id : 1 output 我没有发烧，可以转述为：我并没有发烧的症状。
未找到文件名为 我没有发烧，可以转述为：我并没有发烧的症状。.mp3 的MP3文件。
无重复
student_id : 1 output 我没有手麻的症状。
未找到文件名为 我没有手麻的症状。.mp3 的MP3文件。
无重复
time pass: 302 <class 'int'>
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 35, 36, 37, 38, 39, 40, 41, 42, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
12
眼别
13
时间
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
28
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 58, 59, 63, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
58
治疗效果
59
疾病本身
63
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 83, 84, 85] <class 'list'>
82
set null
/
set null
83
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
[92, 93] <class 'list'>
92
set null
/
set null
93
set null
/
set null
student_id : 12345 output 我的眼睛突然感到疼痛，还出现了红肿，视力也变得模糊。
未找到文件名为 我的眼睛突然感到疼痛，还出现了红肿，视力也变得模糊。.mp3 的MP3文件。
无重复
time pass: 366 <class 'int'>
student_id : 12345 output 我是左眼感觉不舒服。
未找到文件名为 我是左眼感觉不舒服。.mp3 的MP3文件。
无重复
student_id : 12345 output 我从昨天开始有这个症状。
未找到文件名为 我从昨天开始有这个症状。.mp3 的MP3文件。
无重复
student_id : 12345 output 我没有接受过任何治疗，也没有使用过任何眼药水。
未找到文件名为 我没有接受过任何治疗，也没有使用过任何眼药水。.mp3 的MP3文件。
无重复
student_id : 12345 output 现在的精神状态还是没有明显改善，其他方面我没有感觉到明显的变化。
未找到文件名为 现在的精神状态还是没有明显改善，其他方面我没有感觉到明显的变化。.mp3 的MP3文件。
无重复
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 47, 48, 49, 50] <class 'list'>
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
28
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 57, 58, 59, 63, 66, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
57
治疗方案
58
治疗效果
59
疾病本身
63
疾病本身
66
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 83, 84, 85] <class 'list'>
82
set null
/
set null
83
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
[92, 93] <class 'list'>
92
set null
/
set null
93
set null
/
set null
student_id : 123 output 我没有药物过敏。
未找到文件名为 我没有药物过敏。.mp3 的MP3文件。
无重复
student_id : 123 output 我没有食物过敏。
未找到文件名为 我没有食物过敏。.mp3 的MP3文件。
无重复
time pass: 570 <class 'int'>
student_id : 12345 output 我不知道。
有重复
student_id : 12345 output 我没有药物过敏。
有重复
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
12
眼别
13
时间
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
28
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
44
/
set null
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 57, 58, 59, 63, 66, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
2024-07-15 18:26:59.751 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 18:29:53.871 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
127.0.0.1 - - [15/Jul/2024 18:30:35] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 18:30:59] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Jul/2024 18:31:18] "POST /chat HTTP/1.1" 200 -
2024-07-15 18:31:29.738 MediaFileHandler: Missing file ae171f42c29f0a1c21f5c0f8e7072c9e66129ce9bcfc39171342309c.wav
2024-07-15 18:31:34.739 MediaFileHandler: Missing file 86f56d3bcc5ea716f2e1aadfe70e4188840e5ff4480fac515b041b19.wav
2024-07-15 19:29:16.055 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 21:00:59.777 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:19:57.026 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:20:45.026 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:21:33.003 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:22:21.305 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:23:08.981 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:24:13.317 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:24:25.025 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:25:13.196 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:26:01.014 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:26:48.007 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:26:57.133 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:27:45.149 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:28:33.010 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:29:21.158 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:30:08.836 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:30:56.067 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:31:43.967 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:32:32.065 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:33:19.975 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:34:08.182 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:34:56.176 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:35:44.211 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:36:31.998 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:37:20.605 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:38:08.439 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:38:56.699 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:39:44.860 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:40:32.145 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-15 22:41:20.036 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
 * Serving Flask app 'teaching_api_zh'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8892
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 122-334-371

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

 * Detected change in '/home/to_NM/demo_NM_zh/teaching_api_ch.py', reloading
 * Detected change in '/home/to_NM/demo_NM_zh/teaching_api_zh.py', reloading
 * Restarting with watchdog (inotify)
/root/miniconda3/envs/embedding/bin/python: can't open file '/home/to_NM/demo_NM_zh/teaching_api_zh.py': [Errno 2] No such file or directory
  Stopping...
 * Serving Flask app 'teaching_api_ch'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8892
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 122-334-371

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502


Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

 * Serving Flask app 'teaching_api_ch'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8892
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 122-334-371
127.0.0.1 - - [16/Jul/2024 13:37:39] "POST /load HTTP/1.1" 200 -
/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
127.0.0.1 - - [16/Jul/2024 13:37:55] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [16/Jul/2024 13:38:22] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [16/Jul/2024 13:38:40] "POST /chat HTTP/1.1" 200 -

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.

2024-07-16 13:39:28.519 Port 8502 is already in use
 * Serving Flask app 'teaching_api_ch'
 * Debug mode: on
Address already in use
Port 8892 is in use by another program. Either identify and stop that program, or start the server with a different port.
student_id :  output 我的眼睛突然感到疼痛，还出现了红肿，视力也变得模糊不清。
未找到文件名为 我的眼睛突然感到疼痛，还出现了红肿，视力也变得模糊不清。.mp3 的MP3文件。
无重复
student_id :  output 我从昨天开始出现这个症状的。
未找到文件名为 我从昨天开始出现这个症状的。.mp3 的MP3文件。
无重复
student_id :  output 我的眼睛不觉得痒。
未找到文件名为 我的眼睛不觉得痒。.mp3 的MP3文件。
无重复
  Stopping...

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

 * Serving Flask app 'teaching_api_ch'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8892
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 122-334-371
/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
127.0.0.1 - - [16/Jul/2024 17:04:15] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [16/Jul/2024 17:04:21] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [16/Jul/2024 17:06:45] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [16/Jul/2024 17:06:54] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [16/Jul/2024 17:07:16] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [16/Jul/2024 17:10:52] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [16/Jul/2024 17:11:23] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [16/Jul/2024 17:12:14] "POST /chat HTTP/1.1" 200 -
student_id : 1234 output 我的眼睛突然感到疼痛，还出现了红肿，视力也变得模糊不清。
有重复
student_id : 156 output 我的眼皮肿胀并且按压时感到疼痛。
有重复
student_id : 1234 output 不舒服从3天前开始。
未找到文件名为 不舒服从3天前开始。.mp3 的MP3文件。
无重复
student_id : 1234 output 我现在正在担心自己的眼病，请不要闲聊了
未找到文件名为 我现在正在担心自己的眼病，请不要闲聊了.mp3 的MP3文件。
无重复
  Stopping...
Traceback (most recent call last):
  File "/home/to_NM/demo_NM_zh/teaching_api_ch.py", line 2, in <module>
    from flask import Flask, request, jsonify
ModuleNotFoundError: No module named 'flask'

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

python: can't open file '/home/to_NM/demo_NM_zh/teaching_api_zh.py': [Errno 2] No such file or directory
 * Serving Flask app 'teaching_api_ch'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8892
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 122-334-371
127.0.0.1 - - [22/Jul/2024 18:53:07] "POST /load HTTP/1.1" 200 -
2024-07-22 18:53:08.320 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/lib/python3.12/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 17, in <module>
    from pydub import AudioSegment
ModuleNotFoundError: No module named 'pydub'
  Stopping...

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

127.0.0.1 - - [22/Jul/2024 18:56:36] "POST /load HTTP/1.1" 200 -
/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
127.0.0.1 - - [22/Jul/2024 18:58:27] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [22/Jul/2024 18:58:41] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [22/Jul/2024 18:58:53] "POST /chat HTTP/1.1" 200 -
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
12
眼别
13
时间
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
28
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
44
/
set null
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 57, 58, 59, 63, 66, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
57
治疗方案
58
治疗效果
59
疾病本身
63
疾病本身
66
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 83, 84, 85] <class 'list'>
82
set null
/
set null
83
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
[92, 93] <class 'list'>
92
set null
/
set null
93
set null
/
set null
student_id : ijij output 我没有药物或食物过敏。
未找到文件名为 我没有药物或食物过敏。.mp3 的MP3文件。
无重复
student_id : ijij output 我没有药物过敏的历史。
未找到文件名为 我没有药物过敏的历史。.mp3 的MP3文件。
无重复
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
12
眼别
13
时间
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
28
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
44
/
set null
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 57, 58, 59, 63, 66, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
57
治疗方案
58
治疗效果
59
疾病本身
63
疾病本身
66
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 83, 84, 85] <class 'list'>
82
set null
/
set null
83
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
empty
  Stopping...

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

 * Serving Flask app 'teaching_api_ch'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8892
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 122-334-371
/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
2024-07-24 09:46:58.832 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-07-24 09:48:04.632 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
  Stopping...

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

 * Serving Flask app 'teaching_api_ch'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8892
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 122-334-371
  Stopping...

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

 * Serving Flask app 'teaching_api_ch'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8892
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 122-334-371
127.0.0.1 - - [05/Aug/2024 13:40:11] "POST /load HTTP/1.1" 200 -
/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
127.0.0.1 - - [05/Aug/2024 16:20:28] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:23:36] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:23:51] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:24:14] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:24:39] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:26:27] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:27:31] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:28:18] "POST /chat HTTP/1.1" 200 -
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id:  user input: 您好，请问您叫什么名字
----------------ChatZOC database log ----------------

distsnce: [0.20993229746818542, 0.32512742280960083, 0.4070601761341095] 

知识库所有match: ['您叫什么名字？', '您的名字是什么？', '您的姓名是？']


知识库选择: 柳某
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 今年多少岁
----------------ChatZOC database log ----------------

distsnce: [0.2861228287220001, 0.3513767719268799, 0.35745954513549805] 

知识库所有match: ['你今年是多少岁？', '您今年多大岁数？', '您今年几岁？']


知识库选择: 我今年74岁
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 您这次是因为什么不舒服来就诊？
----------------ChatZOC database log ----------------

distsnce: [0.4607711136341095, 0.47708162665367126, 0.4901781380176544] 

知识库所有match: ['请问你是因为什么来医院？', '你为什么来医院？', '你是因为什么来看医生？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西

#医生问题#
您这次是因为什么不舒服来就诊？
response: 我这次来就诊是因为眼睛突然疼痛、发红，看不清东西。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西

#医生问题#
您这次是因为什么不舒服来就诊？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 这种症状有多久了？
----------------ChatZOC database log ----------------

distsnce: [0.05196715518832207, 0.11960892379283905, 0.3436671495437622] 

知识库所有match: ['请问这个症状有多久了？', '这个症状持续了多长时间了？', '请问您的症状持续时间多久？']


知识库选择: 昨天开始的
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 是哪一个眼睛有这种眼红眼痛的表现呢？另一个眼睛有没有不舒服？
----------------ChatZOC database log ----------------

distsnce: [0.3424723446369171, 0.3713250160217285, 0.3773016333580017] 

知识库所有match: ['您眼睛疼痛的具体类别是怎样的？', '眼睛是否有疼痛的感觉？', '您的眼睛疼痛的感觉能具体形容一下吗？']


知识库选择: 是剧烈的胀痛
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 有眼前黑影或视物范围缩小的症状吗？有畏光、流泪的情况吗？
----------------ChatZOC database log ----------------

distsnce: [0.43577802181243896, 0.45643681287765503, 0.4615870714187622] 

知识库所有match: ['之前是否有眼部受伤的经历与眼睛现在的症状是否相关？', '在眼睛出现这些症状之前是否曾经受过伤？', '您的眼睛在出现这些症状之前是否受伤过？']


知识库选择: 我的眼睛没有受伤
我的眼睛没有受伤
我的眼睛没有受伤
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的眼睛没有受伤
我的眼睛没有受伤
我的眼睛没有受伤

#医生问题#
有眼前黑影或视物范围缩小的症状吗？有畏光、流泪的情况吗？
response: 我没有眼前黑影或视物范围缩小的症状，也没有畏光或流泪的情况。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的眼睛没有受伤
我的眼睛没有受伤
我的眼睛没有受伤

#医生问题#
有眼前黑影或视物范围缩小的症状吗？有畏光、流泪的情况吗？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 出现症状之后有去其他医院就诊或者进行过什么治疗吗
----------------ChatZOC database log ----------------

distsnce: [0.3577437996864319, 0.3811279833316803, 0.39770951867103577] 

知识库所有match: ['发病后是否有就医治疗？', '您在症状出现后是否寻求过医疗帮助？', '您是否在症状发作后寻求过专业医疗？']


知识库选择: 我没有去医院看过，也没有用过眼药水
我没有去医院看过，也没有用过眼药水
我没有去医院看过，也没有用过眼药水
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我没有去医院看过，也没有用过眼药水
我没有去医院看过，也没有用过眼药水
我没有去医院看过，也没有用过眼药水

#医生问题#
出现症状之后有去其他医院就诊或者进行过什么治疗吗
response: 我没有去医院看过，也没有用过眼药水。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我没有去医院看过，也没有用过眼药水
我没有去医院看过，也没有用过眼药水
我没有去医院看过，也没有用过眼药水

#医生问题#
出现症状之后有去其他医院就诊或者进行过什么治疗吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 家里有人有青光眼或者其他疾病吗
----------------ChatZOC database log ----------------

distsnce: [0.42040205001831055, 0.4506761431694031, 0.4798809885978699] 

知识库所有match: ['您家里的亲戚是否有人也出现了类似的眼部症状？', '您家里的亲戚中是否有人出现与您类似的眼睛症状？', '家里亲戚的眼睛有没有出现跟你类似的症状？']


知识库选择: 没有
没有
没有
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有
没有
没有

#医生问题#
家里有人有青光眼或者其他疾病吗
response: 我不知道。
127.0.0.1 - - [05/Aug/2024 16:28:48] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:29:13] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:29:42] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:29:51] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:30:07] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:30:50] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:31:37] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:32:21] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:32:34] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:33:28] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:33:51] "POST /chat HTTP/1.1" 200 -



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有
没有
没有

#医生问题#
家里有人有青光眼或者其他疾病吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 之前有没有其他疾病或者做过什么手术呢？
----------------ChatZOC database log ----------------

distsnce: [0.29517683386802673, 0.33494439721107483, 0.4216535985469818] 

知识库所有match: ['之前有没有做过手术？', '在过去有没有进行过手术？', '以前有做过手术吗？']


知识库选择: 我没有做过手术
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 平时抽烟喝酒吗
----------------ChatZOC database log ----------------

distsnce: [0.1858622431755066, 0.2642195224761963, 0.3327521085739136] 

知识库所有match: ['平时抽烟吗？', '平时喝酒吗？', '平时是否有吸烟的行为？']


知识库选择: 我没有抽烟的习惯
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 有没有药物过敏？
----------------ChatZOC database log ----------------

distsnce: [0.20452608168125153, 0.2049809992313385, 0.28677719831466675] 

知识库所有match: ['你之前有没有药物过敏？', '有对什么药物过敏吗？', '您之前是否有药物过敏的情况？']


知识库选择: 我没有药物过敏
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 其他还有什么不适吗?
prev_flag: 2 <class 'int'> <class 'int'>
------------ chatZOC api called -------------------------

student_id:  user input: 除了左眼眼红眼痛，看不清还有其他不适吗
----------------ChatZOC database log ----------------

distsnce: [0.33173438906669617, 0.37399277091026306, 0.4138255715370178] 

知识库所有match: ['除了提到的症状，您的眼睛还有其他不适吗？', '除了眼痛和看不清之外，还有别的问题吗？', '除了目前的症状，您是否还有其他眼睛的不适感？']


知识库选择: 感觉眼睛怕光，很容易流眼泪
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 家里有人有类似的疾病吗
----------------ChatZOC database log ----------------

distsnce: [0.12230955064296722, 0.1707654893398285, 0.5523256063461304] 

知识库所有match: ['请问您家里人有相类似的疾病吗？', '家族里有得过类似的疾病吗？', '您的家族里是否有遗传性疾病或精神病的病例？']


知识库选择: 没有
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 有没有恶心，呕吐的情况
----------------ChatZOC database log ----------------

distsnce: [0.44881755113601685, 0.4794873595237732, 0.5629396438598633] 

知识库所有match: ['有没有呕吐？', '您有没有呕吐的情况？', '有没有想吐？']


知识库选择: 我没有呕吐
我没有呕吐
我没有呕吐
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我没有呕吐
我没有呕吐
我没有呕吐

#医生问题#
有没有恶心，呕吐的情况
response: 我没有恶心和呕吐的情况。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我没有呕吐
我没有呕吐
我没有呕吐

#医生问题#
有没有恶心，呕吐的情况

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 有没有高血压、糖尿病
----------------ChatZOC database log ----------------

distsnce: [0.4936266541481018, 0.4979318678379059, 0.6269037127494812] 

知识库所有match: ['您有没有高血压？', '之前有没有高血压？', '之前有没有糖尿病？']


知识库选择: 是的，我有高血压
是的，我有高血压
我没有糖尿病
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是的，我有高血压
是的，我有高血压
我没有糖尿病

#医生问题#
有没有高血压、糖尿病
response: 我有高血压，但没有糖尿病。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是的，我有高血压
是的，我有高血压
我没有糖尿病

#医生问题#
有没有高血压、糖尿病

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 高血压平时控制的怎么样，有吃药吗，血压最高多少，平时一般控制到多少
----------------ChatZOC database log ----------------

distsnce: [0.32307732105255127, 0.32307732105255127, 0.3255539536476135] 

知识库所有match: ['吃降压药后血压控制得怎样？', '吃降压药后血压控制得怎样？', '您吃降压药后血压的控制情况如何？']


知识库选择: 血压控制得还不错
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 结过婚吗，有几个小孩
----------------ChatZOC database log ----------------

distsnce: [0.5657134056091309, 0.5676507949829102, 0.5929534435272217] 

知识库所有match: ['您是否已经成婚？', '您是否结婚了？', '您是否有孩子？']


知识库选择: 我已经结婚了
我已经结婚了
有1个儿子，1个女儿
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我已经结婚了
我已经结婚了
有1个儿子，1个女儿

#医生问题#
结过婚吗，有几个小孩
response: 我已经结婚了，有1个儿子和1个女儿。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我已经结婚了
我已经结婚了
有1个儿子，1个女儿

#医生问题#
结过婚吗，有几个小孩

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 自从眼睛痛开始，精神、睡眠、食欲、大小便怎么样
----------------ChatZOC database log ----------------

distsnce: [0.5421715974807739, 0.5444685220718384, 0.5854133367538452] 

知识库所有match: ['在眼睛疼痛时还发生了什么', '多久以前开始眼睛疼/痛的？', '您眼睛疼痛的具体类别是怎样的？']


知识库选择: 昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
昨天开始的
是剧烈的胀痛
----------------ChatZOC database log over ----------------
new_prompt: 127.0.0.1 - - [05/Aug/2024 16:34:20] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:36:19] "POST /load HTTP/1.1" 200 -
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
12
眼别
13
时间
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
28
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
44
/
set null
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 57, 58, 59, 63, 66, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
57
治疗方案
58
治疗效果
59
疾病本身
63
疾病本身
66
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 83, 84, 85] <class 'list'>
82
set null
/
set null
83
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
[92, 93] <class 'list'>
92
set null
/
set null
93
set null
/
set null
student_id :  output 我的名字是柳某
有重复
student_id :  output 我今年七十四岁。
有重复
student_id :  output 我这次来就诊是因为眼睛突然疼痛、发红，看不清东西。
未找到文件名为 我这次来就诊是因为眼睛突然疼痛、发红，看不清东西。.mp3 的MP3文件。
无重复
student_id :  output 这种症状是从昨天开始的。
未找到文件名为 这种症状是从昨天开始的。.mp3 的MP3文件。
无重复
student_id :  output 我是左眼有剧烈的胀痛感，右眼目前没有不适。
未找到文件名为 我是左眼有剧烈的胀痛感，右眼目前没有不适。.mp3 的MP3文件。
无重复
time pass: 369 <class 'int'>
student_id :  output 我没有眼前黑影或视物范围缩小的症状，也没有畏光或流泪的情况。
未找到文件名为 我没有眼前黑影或视物范围缩小的症状，也没有畏光或流泪的情况。.mp3 的MP3文件。
无重复
student_id :  output 我没有去医院看过，也没有用过眼药水。
未找到文件名为 我没有去医院看过，也没有用过眼药水。.mp3 的MP3文件。
无重复
student_id :  output 我不知道。
有重复
student_id :  output 我没有接受过任何手术。
未找到文件名为 我没有接受过任何手术。.mp3 的MP3文件。
无重复
student_id :  output 我从不抽烟。
未找到文件名为 我从不抽烟。.mp3 的MP3文件。
无重复
student_id :  output 我没有药物过敏的历史。
有重复
student_id :  output 你问的具体是什么？说详细一点可以吗？
未找到文件名为 你问的具体是什么？说详细一点可以吗？.mp3 的MP3文件。
无重复
student_id :  output 我除了左眼发红、疼痛和视力模糊外，还觉得对光线很敏感，经常不由自主地流泪。
未找到文件名为 我除了左眼发红、疼痛和视力模糊外，还觉得对光线很敏感，经常不由自主地流泪。.mp3 的MP3文件。
无重复
time pass: 632 <class 'int'>
student_id :  output 我没有发现家里人有类似的疾病。
未找到文件名为 我没有发现家里人有类似的疾病。.mp3 的MP3文件。
无重复
student_id :  output 我没有恶心和呕吐的情况。
未找到文件名为 我没有恶心和呕吐的情况。.mp3 的MP3文件。
无重复
student_id :  output 我有高血压，但没有糖尿病。
未找到文件名为 我有高血压，但没有糖尿病。.mp3 的MP3文件。
无重复
student_id :  output 我血压控制得还可以。
未找到文件名为 我血压控制得还可以。.mp3 的MP3文件。
无重复
student_id :  output 我已经结婚了，有1个儿子和1个女儿。
未找到文件名为 我已经结婚了，有1个儿子和1个女儿。.mp3 的MP3文件。
无重复
student_id :  output 自从眼睛开始痛，我的精神状态不太好，睡眠也受到了影响，食欲有所下降，大小便目前还正常。
未找到文件名为 自从眼睛开始痛，我的精神状态不太好，睡眠也受到了影响，食欲有所下降，大小便目前还正常。.mp3 的MP3文件。
无重复
[3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[12, 14, 16, 17, 19, 20, 21, 22, 24, 25, 26, 28, 29, 30, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 46, 47, 48, 49, 50] <class 'list'>
12
眼别
14
进展
16
/
set null
17
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
24
/
set null
25
/
set null
26
症状本身
28
症状本身
29
症状本身
30
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 57, 63, 66, 67, 68, 69, 70, 71, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
57
治疗方案
63
疾病本身
66
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 84, 85] <class 'list'>
82
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[87, 88] <class 'list'>
87
/
set null
88
/
set null
[93] <class 'list'>
93
set null
/
set null
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
12
眼别
13
时间
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
28
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
44
/
set null
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 57, 58, 59, 63, 66, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
57
治疗方案
58
治疗效果
59
疾病本身
63
疾病本身
66
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 83, 84, 85] <class 'list'>
82
set null
/
set null
83
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
[92, 93] <class 'list'>
92
set null
/
set null
93
set null
/
set null127.0.0.1 - - [05/Aug/2024 16:40:13] "POST /load HTTP/1.1" 200 -
2024-08-05 16:41:19.619 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 571, in <module>
    detail_retrieval(st.session_state.state_goal,st.session_state.option)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 338, in detail_retrieval
    response_detail = info_extract_from_excel('现病史',item['问题的序号'],df)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 316, in info_extract_from_excel
    snyp_detail = '-' + row['症状细节']
TypeError: can only concatenate str (not "float") to str
127.0.0.1 - - [05/Aug/2024 16:41:47] "POST /load HTTP/1.1" 200 -
2024-08-05 16:42:00.464 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 571, in <module>
    detail_retrieval(st.session_state.state_goal,st.session_state.option)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 338, in detail_retrieval
    response_detail = info_extract_from_excel('现病史',item['问题的序号'],df)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 316, in info_extract_from_excel
    snyp_detail = '-' + row['症状细节']
TypeError: can only concatenate str (not "float") to str
127.0.0.1 - - [05/Aug/2024 16:42:25] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:42:44] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:43:02] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:43:15] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:43:31] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:43:49] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:44:01] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:44:13] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:44:31] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:44:55] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:45:16] "POST /chat HTTP/1.1" 200 -
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
昨天开始的
是剧烈的胀痛

#医生问题#
自从眼睛痛开始，精神、睡眠、食欲、大小便怎么样
response: 自从眼睛开始痛，我的精神状态不太好，睡眠也受到了影响，食欲有所下降，大小便目前还正常。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
昨天开始的
是剧烈的胀痛

#医生问题#
自从眼睛痛开始，精神、睡眠、食欲、大小便怎么样

**************FINISHED*****************



../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id:  user input: 你叫什么名字
----------------ChatZOC database log ----------------

distsnce: [0.04317820817232132, 0.16676577925682068, 0.24755516648292542] 

知识库所有match: ['您叫什么名字？', '您的名字是什么？', '您叫什么？']


知识库选择: 冯某某
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 今年多少岁
----------------ChatZOC database log ----------------

distsnce: [0.2861228287220001, 0.3513767719268799, 0.35745954513549805] 

知识库所有match: ['你今年是多少岁？', '您今年多大岁数？', '您今年几岁？']


知识库选择: 我今年40岁
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 男性还是女性？
----------------ChatZOC database log ----------------

distsnce: [0.17202123999595642, 0.23855933547019958, 0.23855933547019958] 

知识库所有match: ['您是男性还是女性？', '你是男的还是女的？', '你是男的还是女的？']


知识库选择: 我是女的
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 因为什么来看病？
----------------ChatZOC database log ----------------

distsnce: [0.27657681703567505, 0.4853125214576721, 0.5288928151130676] 

知识库所有match: ['您为什么来看病/我？', '请问你是因为什么来医院？', '你为什么来医院？']


知识库选择: 我的眼皮肿了，压一下还会痛
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 双眼还是单眼？
----------------ChatZOC database log ----------------

distsnce: [0.33219051361083984, 0.38043516874313354, 0.4142717123031616] 

知识库所有match: ['两只眼睛都是吗？', '是哪只眼睛？', '是左眼还是右眼？']


知识库选择: 是左眼
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 右眼有不舒服吗？
----------------ChatZOC database log ----------------

distsnce: [0.2420206069946289, 0.3060809373855591, 0.36823999881744385] 

知识库所有match: ['眼睛还有别的不舒服吗？', '是两只眼睛都不舒服吗？', '眼睛是否有疼痛的感觉？']


知识库选择: 其他没什么不舒服
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 左眼眼皮红肿有多久了
----------------ChatZOC database log ----------------

distsnce: [0.42912307381629944, 0.4514651298522949, 0.46429353952407837] 

知识库所有match: ['眼睛看不清多久了？', '眼睛看不清多长时间了？', '眼睛疼/痛多久了？']


知识库选择: 眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了

#医生问题#
左眼眼皮红肿有多久了
response: 眼皮红肿从3天前开始。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了

#医生问题#
左眼眼皮红肿有多久了

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 这三天之间有觉得它加重或者减轻吗
prev_flag: 1 <class 'int'> <class 'int'>
------------ chatZOC api called -------------------------

student_id:  user input: 发病以来有觉得红肿的部位变大或者发生变化吗
----------------ChatZOC database log ----------------

distsnce: [0.5355846881866455, 0.5983612537384033, 0.6032437086105347] 

知识库所有match: ['红肿的区域皮肤是否有发热的症状？', '红肿的部位皮肤有没有发热的感觉？', '红肿的地方皮肤是否感到温热？']


知识库选择: 会有一点热热的
会有一点热热的
会有一点热热的
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
会有一点热热的
会有一点热热的
会有一点热热的

#医生问题#
发病以来有觉得红肿的部位变大或者发生变化吗
response: 我不知道。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
会有一点热热的
会有一点热热的
会有一点热热的

#医生问题#
发病以来有觉得红肿的部位变大或者发生变化吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 有觉得视力下降吗
----------------ChatZOC database log ----------------

distsnce: [0.2325037717819214, 0.31749486923217773, 0.31991446018218994] 

知识库所有match: ['您有没有感觉到视力下降？', '您是否发现自己的视力有下降的情况？', '你有没有视力下降？']


知识库选择: 我没有视力下降
----------------ChatZOC database log over ----------------
127.0.0.1 - - [05/Aug/2024 16:46:03] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:46:20] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:46:37] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:47:00] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 16:47:33] "POST /chat HTTP/1.1" 200 -
2024-08-05 16:47:54.619 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 571, in <module>
    detail_retrieval(st.session_state.state_goal,st.session_state.option)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 338, in detail_retrieval
    response_detail = info_extract_from_excel('现病史',item['问题的序号'],df)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 316, in info_extract_from_excel
    snyp_detail = '-' + row['症状细节']
TypeError: can only concatenate str (not "float") to str
127.0.0.1 - - [05/Aug/2024 17:44:18] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 17:55:08] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 17:55:54] "POST /chat HTTP/1.1" 200 -
------------ chatZOC api called -------------------------

student_id:  user input: 全身有什么其他疾病吗
----------------ChatZOC database log ----------------

distsnce: [0.4061446785926819, 0.43447160720825195, 0.5021166205406189] 

知识库所有match: ['你有其他全身基础疾病吗', '您还有别的全身病吗？', '之前有没有其他全身慢性病？']


知识库选择: 没有什么问题，挺健康的
没有什么问题，挺健康的
没有什么问题，挺健康的
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有什么问题，挺健康的
没有什么问题，挺健康的
没有什么问题，挺健康的

#医生问题#
全身有什么其他疾病吗
response: 我没有其他疾病。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有什么问题，挺健康的
没有什么问题，挺健康的
没有什么问题，挺健康的

#医生问题#
全身有什么其他疾病吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 有没有甲亢、高血压、糖尿病？
----------------ChatZOC database log ----------------

distsnce: [0.5386559963226318, 0.556212306022644, 0.58807772397995] 

知识库所有match: ['您有没有甲状腺功能亢进的症状？', '之前有没有高血压？', '您有没有高血压？']


知识库选择: 我的甲状腺功能是正常的
我没有高血压
我没有高血压
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的甲状腺功能是正常的
我没有高血压
我没有高血压

#医生问题#
有没有甲亢、高血压、糖尿病？
response: 我没有甲亢、高血压和糖尿病。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的甲状腺功能是正常的
我没有高血压
我没有高血压

#医生问题#
有没有甲亢、高血压、糖尿病？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 以前有没有做过什么手术？
----------------ChatZOC database log ----------------

distsnce: [0.1414148211479187, 0.2040155678987503, 0.23565314710140228] 

知识库所有match: ['之前有没有做过手术？', '在过去有没有进行过手术？', '以前有做过手术吗？']


知识库选择: 我没有做过手术
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 发病以来有没有自己用药或者去医院看病
----------------ChatZOC database log ----------------

distsnce: [0.602608323097229, 0.6106561422348022, 0.6115391254425049] 

知识库所有match: ['有没有用过什么药呀？', '发病后是否有就医治疗？', '在发病后您是否就医过？']


知识库选择: 我以为他自己会好的，就没有去医院看过，也没有用过眼药水，谁知道越来越严重了，就赶紧过来看了
我以为他自己会好的，就没有去医院看过，也没有用过眼药水，谁知道越来越严重了，就赶紧过来看了
我以为他自己会好的，就没有去医院看过，也没有用过眼药水，谁知道越来越严重了，就赶紧过来看了
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我以为他自己会好的，就没有去医院看过，也没有用过眼药水，谁知道越来越严重了，就赶紧过来看了
我以为他自己会好的，就没有去医院看过，也没有用过眼药水，谁知道越来越严重了，就赶紧过来看了
我以为他自己会好的，就没有去医院看过，也没有用过眼药水，谁知道越来越严重了，就赶紧过来看了

#医生问题#
发病以来有没有自己用药或者去医院看病
response: 我没有自己用药，也没有去医院看病。我以为症状会自己好转。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我以为他自己会好的，就没有去医院看过，也没有用过眼药水，谁知道越来越严重了，就赶紧过来看了
我以为他自己会好的，就没有去医院看过，也没有用过眼药水，谁知道越来越严重了，就赶紧过来看了
我以为他自己会好的，就没有去医院看过，也没有用过眼药水，谁知道越来越严重了，就赶紧过来看了

#医生问题#
发病以来有没有自己用药或者去医院看病

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 症状有加重吗
----------------ChatZOC database log ----------------

distsnce: [0.3654785752296448, 0.5745537877082825, 0.5924440026283264] 

知识库所有match: ['症状是突然出现，还是逐渐加重', '发病以来体重有变化吗？', '症状出现后您的体重有何变化？']


知识库选择: 还挺突然的，3天前我感觉眼睛有点痛，一照镜子才发现原来是眼皮红肿了
体重没有明显变化
体重没有明显变化
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
还挺突然的，3天前我感觉眼睛有点痛，一照镜子才发现原来是眼皮红肿了
体重没有明显变化
体重没有明显变化

#医生问题#
症状有加重吗
response: 是的，眼皮红肿的症状突然出现，但在我注意到后的这3天里，我没有感觉到症状有明显加重。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
还挺突然的，3天前我感觉眼睛有点痛，一照镜子才发现原来是眼皮红肿了
体重没有明显变化
体重没有明显变化

#医生问题#
症状有加重吗

**************FINISHED*****************



../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 你有什么不舒服
----------------ChatZOC database log ----------------

distsnce: [0.20991107821464539, 0.2562125027179718, 0.4711831212043762] 

知识库所有match: ['请问你有什么不舒服？', '您怎么不舒服？', '其他还有哪里不舒服吗']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 多久了，哪只眼？
----------------ChatZOC database log ----------------

distsnce: 127.0.0.1 - - [05/Aug/2024 17:59:08] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:00:14] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:00:38] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:01:04] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:01:42] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:02:02] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:03:43] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:04:30] "POST /chat HTTP/1.1" 200 -
2024-08-05 18:35:37.629 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 567, in <module>
    save_point_10min(state_goal=st.session_state.state_goal, points=st.session_state.point,full_point=st.session_state.state_all,timess=passed_time, option=st.session_state.option, student_id=st.session_state.student_id, file_path="student_goal.txt")
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 138, in save_point_10min
    state_out = {"student_id":student_id,"test_option":option,"student_points":round(points/full_point*100,2),"exam_time":timess}
ZeroDivisionError: division by zero
127.0.0.1 - - [05/Aug/2024 18:36:19] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:36:55] "POST /chat HTTP/1.1" 200 -
[0.29757317900657654, 0.3675979971885681, 0.4168635606765747] 

知识库所有match: ['眼睛看不清多久了？', '眼睛看不清多长时间了？', '是哪只眼睛看不清？']


知识库选择: 昨天开始的
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 是胀痛吗
----------------ChatZOC database log ----------------

distsnce: [0.40786027908325195, 0.41294029355049133, 0.5511623620986938] 

知识库所有match: ['是刺痛、胀痛还是隐痛、压痛？', '疼痛有诱因吗', '是否有眼部疼痛？']


知识库选择: 是剧烈的胀痛
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
有
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是剧烈的胀痛
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
有

#医生问题#
是胀痛吗
response: 是胀痛。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是剧烈的胀痛
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
有

#医生问题#
是胀痛吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 22217590 user input: 头痛吗
----------------ChatZOC database log ----------------

distsnce: [0.19915039837360382, 0.24296824634075165, 0.2566494643688202] 

知识库所有match: ['有没有头痛？', '您是否感到头痛？', '会有头痛的感觉吗？']


知识库选择: 可能有吧，特别是左边，眼睛痛了以后感觉头也跟着痛了
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 有没恶心呕吐
----------------ChatZOC database log ----------------

distsnce: [0.29382461309432983, 0.40653517842292786, 0.44610339403152466] 

知识库所有match: ['有没有呕吐？', '有没有想吐？', '您有没有呕吐的情况？']


知识库选择: 我没有呕吐
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 眼压高吗
----------------ChatZOC database log ----------------

distsnce: [0.4266720414161682, 0.5053738951683044, 0.5332974791526794] 

知识库所有match: ['眼睛痛吗？', '是否有眼部疼痛？', '您的眼痛有加重吗？']


知识库选择: 有
有
没有，一直都很痛
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
有
有
没有，一直都很痛

#医生问题#
眼压高吗
response: 我不知道。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
有
有
没有，一直都很痛

#医生问题#
眼压高吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 22217590 user input: 你叫什么名字，今年多大
----------------ChatZOC database log ----------------

distsnce: [0.3912564516067505, 0.48570483922958374, 0.5061712861061096] 

知识库所有match: ['您叫什么名字？', '您的名字是什么？', '您的姓名是？']


知识库选择: 柳某
柳某
柳某
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
柳某
柳某
柳某

#医生问题#
你叫什么名字，今年多大
response: 我叫柳某，但我的年龄在提供的信息中没有提及，所以我无法回答我今年多大。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
柳某
柳某
柳某

#医生问题#
你叫什么名字，今年多大

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 22217590 user input: 你家里人有同样的症状吗
----------------ChatZOC database log ----------------

distsnce: [0.318429559469223, 0.4373875856399536, 0.46596193313598633] 

知识库所有match: ['请问您家里人有相类似的疾病吗？', '您家里的亲戚是否有人也出现了类似的眼部症状？', '家族里有得过类似的疾病吗？']


知识库选择: 没有
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 你做什么工作的
----------------ChatZOC database log ----------------

distsnce: [0.16001051664352417, 0.2092922329902649, 0.26259464025497437] 

知识库所有match: ['您从事的是什么工作？', '你的工作是什么？', '您平时是从事什么工作的？']


知识库选择: 我已经退休了
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 您有什么不舒服吗
----------------ChatZOC database log ----------------

distsnce: [0.14149804413318634, 0.19523456692695618, 0.4297010600566864] 

知识库所有match: ['请问你有什么不舒服？', '您怎么不舒服？', '您眼睛有什么不舒服？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 你叫什么名字？结婚了吗？有什么全身的疾病吗？眼部之前有过什么病吗
----------------ChatZOC database log ----------------

distsnce: [0.4451220631599426, 0.4451220631599426, 0.5867074131965637] 

知识库所有match: ['你的眼睛在这之前有什么疾病吗？', '你的眼睛在这之前有什么疾病吗？', '您的眼睛之前是否患过其他疾病？']


知识库选择: 我5年前体检的时候发现两只眼睛都有白内障，但医生说先不用处理，所以我也没管他
我5年前体检的时候发现两只眼睛都有白内障，但医生说先不用处理，所以我也没管他
我5年前体检的时候发现两只眼睛都有白内障，但医生说先不用处理，所以我也没管他
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我5年前体检的时候发现两只眼睛都有白内障，但医生说先不用处理，所以我也没管他
我5年前体检的时候发现两只眼睛都有白内障，但医生说先不用处理，所以我也没管他
我5年前体检的时候发现两只眼睛都有白内障，但医生说先不用处理，所以我也没管他

#医生问题#
你叫什么名字？结婚了吗？有什么全身的疾病吗？眼部之前有过什么病吗
response: 127.0.0.1 - - [05/Aug/2024 18:38:51] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:39:51] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:40:26] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:40:37] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:41:20] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:41:45] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:42:43] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:43:23] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:43:46] "POST /chat HTTP/1.1" 200 -

[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
12
眼别
13
时间
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
nan
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
12
眼别
13
时间
14
进展
15
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
nan
student_id :  output 我的名字是冯某某
有重复
student_id :  output 我今年四十。
未找到文件名为 我今年四十。.mp3 的MP3文件。
无重复
student_id :  output 我是女性。
未找到文件名为 我是女性。.mp3 的MP3文件。
无重复
student_id :  output 我来看病是因为眼皮发肿，按下去还会感到疼痛。
未找到文件名为 我来看病是因为眼皮发肿，按下去还会感到疼痛。.mp3 的MP3文件。
无重复
student_id :  output 我是左眼。
未找到文件名为 我是左眼。.mp3 的MP3文件。
无重复
student_id :  output 我右眼没有感觉到其他不适。
未找到文件名为 我右眼没有感觉到其他不适。.mp3 的MP3文件。
无重复
student_id :  output 眼皮红肿从3天前开始。
未找到文件名为 眼皮红肿从3天前开始。.mp3 的MP3文件。
无重复
student_id :  output 能不能问的再仔细点？具体指的是？
未找到文件名为 能不能问的再仔细点？具体指的是？.mp3 的MP3文件。
无重复
student_id :  output 我不知道。
有重复
student_id :  output 我没有感觉到视力有任何下降。 \n\n或者\n\n我没觉得我的视力变差。
未找到文件名为 我没有感觉到视力有任何下降。 \n\n或者\n\n我没觉得我的视力变差。.mp3 的MP3文件。
无重复
student_id :  output 我没有其他疾病。
未找到文件名为 我没有其他疾病。.mp3 的MP3文件。
无重复
student_id :  output 我没有甲亢、高血压和糖尿病。
未找到文件名为 我没有甲亢、高血压和糖尿病。.mp3 的MP3文件。
无重复
student_id :  output 我从未接受过任何手术。
未找到文件名为 我从未接受过任何手术。.mp3 的MP3文件。
无重复
student_id :  output 我没有自己用药，也没有去医院看病。我以为症状会自己好转。
未找到文件名为 我没有自己用药，也没有去医院看病。我以为症状会自己好转。.mp3 的MP3文件。
无重复
student_id :  output 是的，眼皮红肿的症状突然出现，但在我注意到后的这3天里，我没有感觉到症状有明显加重。
未找到文件名为 是的，眼皮红肿的症状突然出现，但在我注意到后的这3天里，我没有感觉到症状有明显加重。.mp3 的MP3文件。
无重复
time pass: 316 <class 'int'>
[4, 5, 6, 7, 8, 9, 10] <class 'list'>
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 40, 41, 42, 43, 46, 47, 48, 49] <class 'list'>
14
进展
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
nan
student_id : 22217590 output 我眼部突然感到疼痛，还出现了红肿，视力也变得模糊。
未找到文件名为 我眼部突然感到疼痛，还出现了红肿，视力也变得模糊。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我从昨天开始感觉不适。
未找到文件名为 我从昨天开始感觉不适。.mp3 的MP3文件。
无重复
student_id : 22217590 output 是胀痛。
未找到文件名为 是胀痛。.mp3 的MP3文件。
无重复
time pass: 315 <class 'int'>
student_id : 22217590 output 我好像有点头痛，尤其是左边，感觉眼睛痛了之后，头部也开始痛了起来。
未找到文件名为 我好像有点头痛，尤其是左边，感觉眼睛痛了之后，头部也开始痛了起来。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我没有出现呕吐的情况。 \n\n或者\n\n我并没有呕吐。
未找到文件名为 我没有出现呕吐的情况。 \n\n或者\n\n我并没有呕吐。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我不知道。
有重复
student_id : 22217590 output 我叫柳某，但我的年龄在提供的信息中没有提及，所以我无法回答我今年多大。
未找到文件名为 我叫柳某，但我的年龄在提供的信息中没有提及，所以我无法回答我今年多大。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我没有家庭成员有同样的症状。
未找到文件名为 我没有家庭成员有同样的症状。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我目前已退休了。
未找到文件名为 我目前已退休了。.mp3 的MP3文件。
无重复
time pass: 2438 <class 'int'>
student_id : 22217590 output 我眼部突然感到疼痛，还出现了红肿，视力也变得模糊了。
未找到文件名为 我眼部突然感到疼痛，还出现了红肿，视力也变得模糊了。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我不知道。我没有提供我的名字、婚姻状况、全身性疾病或眼部的其他病史。您需要的是关于我眼睛白内障的信息，这已经在患者资料中提过了。
未找到文件名为 我不知道。我没有提供我的名字、婚姻状况、全身性疾病或眼部的其他病史。您需要的是关于我眼睛白内障的信息.mp3 的MP3文件。
无重复
student_id : 22217590 output 我五年前在体检中查出双眼患有白内障，当时医生建议暂不需要治疗，所以我就没采取任何措施。
未找到文件名为 我五年前在体检中查出双眼患有白内障，当时医生建议暂不需要治疗，所以我就没采取任何措施。.mp3 的MP3文件。
无重复
student_id : 22217590 output 是的，我的眼睛感到胀痛。
未找到文件名为 是的，我的眼睛感到胀痛。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我好像是的，尤其是左边，感觉眼睛痛了之后头痛也跟着来了。
未找到文件名为 我好像是的，尤其是左边，感觉眼睛痛了之后头痛也跟着来了。.mp3 的MP3文件。
无重复
student_id : 22217590 output 痛了昨天一整天，具体时间是从昨天开始的。
未找到文件名为 痛了昨天一整天，具体时间是从昨天开始的。.mp3 的MP3文件。
无重复
time pass: 311 <class 'int'>
student_id : 22217590 output 不是持续的，我不知道具体什么时候开始痛的，但昨天吵架时痛得比较厉害。
未找到文件名为 不是持续的，我不知道具体什么时候开始痛的，但昨天吵架时痛得比较厉害。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我的左边眼睛看东西很模糊，但具体视力下降的程度我不清楚。
未找到文件名为 我的左边眼睛看东西很模糊，但具体视力下降的程度我不清楚。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我的眼睛突然感到不适。
未找到文件名为 我的眼睛突然感到不适。.mp3 的MP3文件。
无重复
student_id : 22217590 output 127.0.0.1 - - [05/Aug/2024 18:46:42] "POST /chat HTTP/1.1" 200 -
我不知道。我没有提供我的名字、婚姻状况、全身性疾病或眼部的其他病史。您需要的是关于我眼睛白内障的信息，这已经在患者资料中提过了。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我5年前体检的时候发现两只眼睛都有白内障，但医生说先不用处理，所以我也没管他
我5年前体检的时候发现两只眼睛都有白内障，但医生说先不用处理，所以我也没管他
我5年前体检的时候发现两只眼睛都有白内障，但医生说先不用处理，所以我也没管他

#医生问题#
你叫什么名字？结婚了吗？有什么全身的疾病吗？眼部之前有过什么病吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 22217590 user input: 你眼睛有过什么其他疾病吗
----------------ChatZOC database log ----------------

distsnce: [0.1428593099117279, 0.1428593099117279, 0.20133206248283386] 

知识库所有match: ['你的眼睛在这之前有什么疾病吗？', '你的眼睛在这之前有什么疾病吗？', '您的眼睛之前是否患过其他疾病？']


知识库选择: 我5年前体检的时候发现两只眼睛都有白内障，但医生说先不用处理，所以我也没管他
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 你的眼睛胀痛吗？
----------------ChatZOC database log ----------------

distsnce: [0.10681390762329102, 0.12128669023513794, 0.15231402218341827] 

知识库所有match: ['您是否感到眼睛疼痛？', '眼睛痛吗？', '是否有眼部疼痛？']


知识库选择: 有
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 头痛吗？
----------------ChatZOC database log ----------------

distsnce: [0.17611193656921387, 0.21088650822639465, 0.22604653239250183] 

知识库所有match: ['有没有头痛？', '您是否感到头痛？', '会有头痛的感觉吗？']


知识库选择: 可能有吧，特别是左边，眼睛痛了以后感觉头也跟着痛了
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 痛了多久啦？
----------------ChatZOC database log ----------------

distsnce: [0.4405856728553772, 0.45033326745033264, 0.4855826497077942] 

知识库所有match: ['您是怎么痛的？', '眼睛疼/痛多长时间了？', '多长时间了？']


知识库选择: 是剧烈的胀痛
昨天开始的
昨天开始的
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是剧烈的胀痛
昨天开始的
昨天开始的

#医生问题#
痛了多久啦？
response: 痛了昨天一整天，具体时间是从昨天开始的。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是剧烈的胀痛
昨天开始的
昨天开始的

#医生问题#
痛了多久啦？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 22217590 user input: 是持续痛吗
----------------ChatZOC database log ----------------

distsnce: [0.5076625943183899, 0.6049939393997192, 0.6270219087600708] 

知识库所有match: ['疼痛有诱因吗', '可以具体描述一下你的疼痛吗？', '是刺痛、胀痛还是隐痛、压痛？']


知识库选择: 昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
是剧烈的胀痛
是剧烈的胀痛
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
是剧烈的胀痛
是剧烈的胀痛

#医生问题#
是持续痛吗
response: 不是持续的，我不知道具体什么时候开始痛的，但昨天吵架时痛得比较厉害。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
是剧烈的胀痛
是剧烈的胀痛

#医生问题#
是持续痛吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 22217590 user input: 视力下降严重吗
----------------ChatZOC database log ----------------

distsnce: [0.4202835261821747, 0.458435595035553, 0.47010019421577454] 

知识库所有match: ['您是否发现自己的视力有下降的情况？', '你有没有视力下降？', '您有没有感觉到视力下降？']


知识库选择: 我左边眼睛看东西很模糊
我左边眼睛看东西很模糊
我左边眼睛看东西很模糊
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我左边眼睛看东西很模糊
我左边眼睛看东西很模糊
我左边眼睛看东西很模糊

#医生问题#
视力下降严重吗
response: 我的左边眼睛看东西很模糊，但具体视力下降的程度我不清楚。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我左边眼睛看东西很模糊
我左边眼睛看东西很模糊
我左边眼睛看东西很模糊

#医生问题#
视力下降严重吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 22217590 user input: 是突然出现的吗
----------------ChatZOC database log ----------------

distsnce: [0.045841850340366364, 0.5477511286735535, 0.5674611926078796] 

知识库所有match: ['是突然出现的吗？', '什么时候出现的？', '之前有出现过这样的情况吗']


知识库选择: 我的眼睛不舒服是突然出现的
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 有什么诱因吗
----------------ChatZOC database log ----------------

distsnce: [0.19180233776569366, 0.21823182702064514, 0.3898358643054962] 

知识库所有match: ['你有什么诱因吗？', '是什么诱因导致的', '你觉得出现这种情况有什么诱因吗？']


知识库选择: 昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 有什么家族史？
prev_flag: 2 <class 'int'> <class 'int'>
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 有高血压，糖尿病等疾病吗？
----------------ChatZOC database log ----------------

distsnce: [0.37085187435150146, 0.3841928541660309, 0.44882071018218994] 

知识库所有match: 127.0.0.1 - - [05/Aug/2024 18:47:06] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:47:34] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:48:05] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 18:48:34] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:44:30] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:45:20] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:45:46] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:46:23] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:46:44] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:47:01] "POST /chat HTTP/1.1" 200 -
['之前是否被诊断出患有高血压？', '之前是否有高血压的病史？', '您得过高血压吗？']


知识库选择: 是的，我有高血压
是的，我有高血压
是的，我有高血压
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是的，我有高血压
是的，我有高血压
是的，我有高血压

#医生问题#
有高血压，糖尿病等疾病吗？
response: 我有高血压。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是的，我有高血压
是的，我有高血压
是的，我有高血压

#医生问题#
有高血压，糖尿病等疾病吗？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 22217590 user input: 您有什么家族性疾病吗？
----------------ChatZOC database log ----------------

distsnce: [0.2920322120189667, 0.32426780462265015, 0.34024694561958313] 

知识库所有match: ['您的家族里是否有遗传性疾病或精神病的病例？', '家族里有得过类似的疾病吗？', '在您的家族中，是否有遗传病或精神病的情况？']


知识库选择: 没有
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 22217590 user input: 结婚了吗？几岁？生了几个小孩？
----------------ChatZOC database log ----------------

distsnce: [0.5149486064910889, 0.5161828398704529, 0.5451680421829224] 

知识库所有match: ['您是否已经成婚？', '您是否结婚了？', '您是否成婚？']


知识库选择: 我已经结婚了
我已经结婚了
我已经结婚了
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我已经结婚了
我已经结婚了
我已经结婚了

#医生问题#
结婚了吗？几岁？生了几个小孩？
response: 结婚了，具体年龄是#患者信息#中没有提到的，我生了几个小孩也没有在信息中说明。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我已经结婚了
我已经结婚了
我已经结婚了

#医生问题#
结婚了吗？几岁？生了几个小孩？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 22217590 user input: 有什么过敏？
----------------ChatZOC database log ----------------

distsnce: [0.217058002948761, 0.2373540699481964, 0.4423927664756775] 

知识库所有match: ['有对什么药物过敏吗？', '有对什么食物过敏吗？', '您之前是否有药物过敏的情况？']


知识库选择: 我没有药物过敏
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: test1 user input: 你好 请问你感觉有何不适？
----------------ChatZOC database log ----------------

distsnce: [0.4744376540184021, 0.5609846115112305, 0.6389381885528564] 

知识库所有match: ['请问你有什么不舒服？', '您眼睛有什么不适感？', '您怎么不舒服？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西

#医生问题#
你好 请问你感觉有何不适？
response: 我感到眼睛突然疼痛、发红，看不清东西。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西
我的眼睛突然疼痛、发红，看不清东西

#医生问题#
你好 请问你感觉有何不适？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: test1 user input: 哪只眼睛呢？这个症状持续多久了？
----------------ChatZOC database log ----------------

distsnce: [0.317731112241745, 0.3201700448989868, 0.3366599678993225] 

知识库所有match: ['是否有任何特定的原因导致了眼睛出现这些症状？', '眼睛看不清多久了？', '眼睛看不清多长时间了？']


知识库选择: 昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: test1 user input: 有没有头晕、恶心、呕吐或者还有其他症状吗？
----------------ChatZOC database log ----------------

distsnce: [0.30952703952789307, 0.39849454164505005, 0.4751932919025421] 

知识库所有match: ['您是否有头晕的症状？', '有没有头晕？', '会有头晕的感觉吗？']


知识库选择: 我没有头晕
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: test1 user input: 请问你是否有其他全身病？
----------------ChatZOC database log ----------------

distsnce: [0.1704508662223816, 0.27594298124313354, 0.2774861454963684] 

知识库所有match: ['您还有别的全身病吗？', '您是否患有其他传染性疾病？', '你有其他全身基础疾病吗']


知识库选择: 没有
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: test1 user input: 你的家里人有没有眼部相关的疾病？
----------------ChatZOC database log ----------------

distsnce: [0.2544516623020172, 0.27178677916526794, 0.28440260887145996] 

知识库所有match: ['家里亲戚的眼睛有没有出现跟你类似的症状？', '您家里的亲戚中是否有人出现与您类似的眼睛症状？', '您家里的亲戚是否有人也出现了类似的眼部症状？']


知识库选择: 没有
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: test1 user input: 你家里人有没有青光眼？
----------------ChatZOC database log ----------------

distsnce: [0.5130072832107544, 0.5246089696884155, 0.539930522441864] 

知识库所有match: ['家里亲戚的眼睛有没有出现跟你类似的症状？', '您有没有让脏东西进入眼睛？', '您家里的亲戚中是否有人出现与您类似的眼睛症状？']


知识库选择: 没有
没有脏东西入眼
没有
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有
没有脏东西入眼
没有

#医生问题#
你家里人有没有青光眼？
response: 127.0.0.1 - - [05/Aug/2024 20:47:14] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:47:28] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:48:03] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:48:46] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:49:01] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:49:19] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:49:38] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:50:01] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:50:20] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:52:30] "POST /load HTTP/1.1" 200 -
我不知道。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有
没有脏东西入眼
没有

#医生问题#
你家里人有没有青光眼？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: test1 user input: 你之前有过类似的症状吗？
----------------ChatZOC database log ----------------

distsnce: [0.26658105850219727, 0.370286762714386, 0.38283056020736694] 

知识库所有match: ['你之前出现过类似的情况吗？', '您是否经历过恶心的症状？', '请问您之前出现过类似的情况吗？']


知识库选择: 我以前没有出现过这种突然的眼红眼痛
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: test1 user input: 你是那只眼睛疼痛？
----------------ChatZOC database log ----------------

distsnce: [0.17245136201381683, 0.211279958486557, 0.2610926628112793] 

知识库所有match: ['您是否感到眼睛疼痛？', '您的眼睛是一直痛还是一阵阵痛？', '是否有眼部疼痛？']


知识库选择: 有
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: test1 user input: 你是否做过眼睛的手术
----------------ChatZOC database log ----------------

distsnce: [0.3940173089504242, 0.44309109449386597, 0.47525447607040405] 

知识库所有match: ['你的眼睛干吗？', '您是否觉得眼睛干涩？', '您是否把脏东西弄进了眼睛里？']


知识库选择: 我眼睛没有干涩
我眼睛没有干涩
没有脏东西入眼
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我眼睛没有干涩
我眼睛没有干涩
没有脏东西入眼

#医生问题#
你是否做过眼睛的手术
response: 我没有做过眼睛的手术。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我眼睛没有干涩
我眼睛没有干涩
没有脏东西入眼

#医生问题#
你是否做过眼睛的手术

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: test1 user input: 眼部是否有受过外伤
----------------ChatZOC database log ----------------

distsnce: [0.3337913453578949, 0.37306585907936096, 0.39646121859550476] 

知识库所有match: ['是否有眼部疼痛？', '眼睛出现这些症状之前有没有受伤？', '眼睛痛吗？']


知识库选择: 有
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: test1 user input: 哪只眼睛受过伤？是怎么受伤的
----------------ChatZOC database log ----------------

distsnce: [0.29305407404899597, 0.3470655679702759, 0.41216930747032166] 

知识库所有match: ['在眼睛疼痛时还发生了什么', '您眼睛疼痛的具体类别是怎样的？', '眼睛出现这些症状之前有没有受伤？']


知识库选择: 昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: test1 user input: 你的眼睛如何受伤的
----------------ChatZOC database log ----------------

distsnce: [0.37736690044403076, 0.4573354721069336, 0.4644358158111572] 

知识库所有match: ['您眼睛疼痛的具体类别是怎样的？', '您的眼睛是一直痛还是一阵阵痛？', '在眼睛疼痛时还发生了什么']


知识库选择: 是剧烈的胀痛
是持续性的
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是剧烈的胀痛
是持续性的
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了

#医生问题#
你的眼睛如何受伤的
response: 我的眼睛不舒服是因为昨天跟家里人吵架，情绪激动导致的，具体怎么受伤的我不清楚。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是剧烈的胀痛
是持续性的
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了

#医生问题#
你的眼睛如何受伤的

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: test1 user input: 有无食物药物过敏
----------------ChatZOC database log ----------------

distsnce: [0.42770102620124817, 0.4543967843055725, 0.4749273359775543] 

知识库所有match: ['有对什么食物过敏吗？', '有对什么药物过敏吗？', '你之前有没有食物过敏？']


知识库选择: 没有食物过敏
我没有药物过敏
没有食物过敏
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有食物过敏
我没有药物过敏
没有食物过敏

#医生问题#
有无食物药物过敏
response: 我没有食物和药物过敏。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有食物过敏
我没有药物过敏
没有食物过敏

#医生问题#
有无食物药物过敏

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: test1 user input: 你多少岁了 是否结婚？有几个孩子
----------------ChatZOC database log ----------------

distsnce: [0.3991420567035675, 0.43187546730041504, 0.43486806750297546] 

知识库所有match: ['您是否已经成婚？', '您是否成婚？', '您是否结婚了？']


知识库选择: 我已经结婚了
我已经结婚了
我已经结婚了
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我已经结婚了
我已经结婚了
我已经结婚了

#医生问题#
你多少岁了 是否结婚？有几个孩子
response: 我结婚了，但患者信息中没有提到我的年龄和孩子的数量，所以我不知道。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我已经结婚了
我已经结婚了
我已经结婚了

#医生问题#
你多少岁了 是否结婚？有几个孩子

**************FINISHED*****************



../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 123 user input: 你好 请问你叫什么名字
127.0.0.1 - - [05/Aug/2024 20:52:47] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:52:57] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:53:14] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:53:31] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:53:44] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:54:26] "POST /chat HTTP/1.1" 200 -
我昨天和家人发生了争执，情绪一时之间比较激动，之后我的眼睛就开始感到不适了。
未找到文件名为 我昨天和家人发生了争执，情绪一时之间比较激动，之后我的眼睛就开始感到不适了。.mp3 的MP3文件。
无重复
student_id : 22217590 output 能问详细点吗？具体是？
有重复
time pass: 632 <class 'int'>
student_id : 22217590 output 我有高血压。
未找到文件名为 我有高血压。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我没有家族遗传病的记录。
未找到文件名为 我没有家族遗传病的记录。.mp3 的MP3文件。
无重复
student_id : 22217590 output 结婚了，具体年龄是#患者信息#中没有提到的，我生了几个小孩也没有在信息中说明。
未找到文件名为 结婚了，具体年龄是#患者信息#中没有提到的，我生了几个小孩也没有在信息中说明。.mp3 的MP3文件。
无重复
student_id : 22217590 output 我没有任何药物过敏史。
未找到文件名为 我没有任何药物过敏史。.mp3 的MP3文件。
无重复
[1, 2, 3, 4, 5, 6, 7, 8, 9] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
[12, 15, 17, 18, 19, 20, 21, 24, 25, 26, 28, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
12
眼别
15
症状本身
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
24
/
set null
25
/
set null
26
症状本身
28
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
44
/
set null
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[52, 53, 55, 56, 57, 58, 59, 63, 66, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
52
/
set null
53
set null
/
set null
55
发病时长
56
严重程度
57
治疗方案
58
治疗效果
59
疾病本身
63
疾病本身
66
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 83, 85] <class 'list'>
82
set null
/
set null
83
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
[93] <class 'list'>
93
set null
/
set null
student_id : test1 output 我感到眼睛突然疼痛、发红，看不清东西。
未找到文件名为 我感到眼睛突然疼痛、发红，看不清东西。.mp3 的MP3文件。
无重复
student_id : test1 output 昨天我因为和家人发生争执，情绪变得相当激动，从那时起我的眼睛就开始感到不适了。
未找到文件名为 昨天我因为和家人发生争执，情绪变得相当激动，从那时起我的眼睛就开始感到不适了。.mp3 的MP3文件。
无重复
student_id : test1 output 我没有感到头晕。
未找到文件名为 我没有感到头晕。.mp3 的MP3文件。
无重复
student_id : test1 output 我没有其他的全身性疾病。
未找到文件名为 我没有其他的全身性疾病。.mp3 的MP3文件。
无重复
student_id : test1 output 我没有家庭成员有眼部相关的疾病。
未找到文件名为 我没有家庭成员有眼部相关的疾病。.mp3 的MP3文件。
无重复
student_id : test1 output 我不知道。
有重复
student_id : test1 output 我之前并没有经历过这种突然间的眼睛发红和疼痛。
未找到文件名为 我之前并没有经历过这种突然间的眼睛发红和疼痛。.mp3 的MP3文件。
无重复
student_id : test1 output 我是左眼疼痛。 \n\n（假设医生问的是哪一只眼睛，这里以左眼为例进行同义转述。如果医生的问题是指“是否疼痛”，那么可以转述为：“是的，我的一只眼睛疼。”）
未找到文件名为 我是左眼疼痛。 \n\n（假设医生问的是哪一只眼睛，这里以左眼为例进行同义转述。如果医生的问题是指“.mp3 的MP3文件。
无重复
student_id : test1 output 我没有做过眼睛的手术。
未找到文件名为 我没有做过眼睛的手术。.mp3 的MP3文件。
无重复
student_id : test1 output 我之前眼部受过伤。
未找到文件名为 我之前眼部受过伤。.mp3 的MP3文件。
无重复
student_id : test1 output 昨天我和家人发生争执，情绪一时激动起来，随后我的眼睛就感到不适了。
未找到文件名为 昨天我和家人发生争执，情绪一时激动起来，随后我的眼睛就感到不适了。.mp3 的MP3文件。
无重复
student_id : test1 output 我的眼睛不舒服是因为昨天跟家里人吵架，情绪激动导致的，具体怎么受伤的我不清楚。
未找到文件名为 我的眼睛不舒服是因为昨天跟家里人吵架，情绪激动导致的，具体怎么受伤的我不清楚。.mp3 的MP3文件。
无重复
time pass: 317 <class 'int'>
student_id : test1 output 我没有食物和药物过敏。
未找到文件名为 我没有食物和药物过敏。.mp3 的MP3文件。
无重复
student_id : test1 output 我结婚了，但患者信息中没有提到我的年龄和孩子的数量，所以我不知道。
未找到文件名为 我结婚了，但患者信息中没有提到我的年龄和孩子的数量，所以我不知道。.mp3 的MP3文件。
无重复
[1, 2, 3, 4, 5, 6, 7, 8, 9] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
[12, 13, 14, 15, 17, 18, 19, 21, 23, 24, 25, 26, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
12
眼别
13
时间
14
进展
15
症状本身
17
/
set null
18
/
set null
19
/
set null
21
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
44
/
set null
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 53, 54, 55, 56, 57, 58, 59, 63, 66, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
57
治疗方案
58
治疗效果
59
疾病本身
63
疾病本身
66
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 84, 85] <class 'list'>
82
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
[92] <class 'list'>
92
set null
/
set null
student_id : 123 output 我的名字是冯某某
有重复
student_id : 123 output 我今年四十。
有重复
student_id : 123 output 我的眼皮感到肿胀，按压时还会感到疼痛。
未找到文件名为 我的眼皮感到肿胀，按压时还会感到疼痛。.mp3 的MP3文件。
无重复
student_id : 123 output 我是左眼。
有重复
student_id : 123 output 眼皮红肿和疼痛是从三天前开始的，从昨天起眼皮上出现了小白点，而今天这个症状变得更加严重了。
未找到文件名为 眼皮红肿和疼痛是从三天前开始的，从昨天起眼皮上出现了小白点，而今天这个症状变得更加严重了。.mp3 的MP3文件。
无重复
student_id : 123 output 我平时工作时会化妆，但晚上都会卸妆。不确定这是否与目前的状况有关。除此之外，我没有特别注意到其他诱发因素。
----------------ChatZOC database log ----------------

distsnce: [0.14057879149913788, 0.2704537808895111, 0.3686884641647339] 

知识库所有match: ['您叫什么名字？', '您的名字是什么？', '您的姓名是？']


知识库选择: 冯某某
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 123 user input: 你几岁了
----------------ChatZOC database log ----------------

distsnce: [0.22176074981689453, 0.29001596570014954, 0.3733409643173218] 

知识库所有match: ['您目前几岁了？', '您今年几岁？', '你今年是多少岁？']


知识库选择: 我今年40岁
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 123 user input: 请问你有什么不舒服
----------------ChatZOC database log ----------------

distsnce: [0.04460373520851135, 0.30208396911621094, 0.4138685464859009] 

知识库所有match: ['请问你有什么不舒服？', '您怎么不舒服？', '其他还有哪里不舒服吗']


知识库选择: 我的眼皮肿了，压一下还会痛
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 123 user input: 哪只眼睛
----------------ChatZOC database log ----------------

distsnce: [0.10695452988147736, 0.17614684998989105, 0.30060529708862305] 

知识库所有match: ['是哪只眼睛？', '哪边的眼睛？', '是哪只眼睛看不清？']


知识库选择: 是左眼
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 123 user input: 这个症状持续多久、了
----------------ChatZOC database log ----------------

distsnce: [0.17077761888504028, 0.24952276051044464, 0.37983739376068115] 

知识库所有match: ['这个症状持续了多长时间了？', '请问这个症状有多久了？', '这种症状是突然出现的，还是慢慢发生的']


知识库选择: 眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 123 user input: 有没有什么诱发因素
----------------ChatZOC database log ----------------

distsnce: [0.5100775957107544, 0.5634053945541382, 0.6428279876708984] 

知识库所有match: ['是什么诱因导致的', '你有什么诱因吗？', '有没有什么诱因导致你眼睛看不清？']


知识库选择: 我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系

#医生问题#
有没有什么诱发因素
response: 我平时工作时会化妆，但晚上都会卸妆。不确定这是否与目前的状况有关。除此之外，我没有特别注意到其他诱发因素。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系

#医生问题#
有没有什么诱发因素

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 123 user input: 127.0.0.1 - - [05/Aug/2024 20:54:51] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:55:13] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:55:26] "POST /chat HTTP/1.1" 200 -
问答结束

您的分数为: 14.51

您的用时为: 373 s

请点击左边栏返回标准病人选择界面重新选择

[基本信息]部分的缺漏为：
姓名,问题的例子是：您的名字是什么？
年龄,问题的例子是：您的年龄是多少岁？
性别,问题的例子是：您是男性还是女性？
籍贯,问题的例子是：您来自哪里？
住址,问题的例子是：你住在哪？
电话,问题的例子是：您的电话号码是多少？
工作,问题的例子是：您的职业是什么？
学历,问题的例子是：你的受教育水平是什么？
民族,问题的例子是：您是哪个民族的？

[现病史]部分的缺漏为：
症状-主要症状-眼别,问题的例子是：是左眼还是右眼？
症状-主要症状-时间,问题的例子是：多长时间了？
症状-主要症状-进展,问题的例子是：是突发的还是缓慢出现的
症状-伴随症状-症状本身,问题的例子是：除了提到的症状，您的眼睛还有其他不适吗？
诱因-情绪,问题的例子是：你是在情绪激动以后发病的吗？
诱因-外伤,问题的例子是：您的眼睛在出现这些症状之前是否受伤过？
诱因-化妆,问题的例子是：你会经常化妆吗？
症状-眼红-症状本身,问题的例子是：您最近是否出现眼睛发红的情况？
症状-眼痛-症状性质,问题的例子是：您是怎么痛的？
症状-眼痛,问题的例子是：您的眼痛是持续性还是间歇性的？
症状-眼痛,问题的例子是：眼痛是否随时间变化？
症状-眼痒-症状本身,问题的例子是：你的眼睛痒吗？
症状-头痛-症状本身,问题的例子是：您是否感到头痛？
症状-恶心-症状本身,问题的例子是：您有没有感到恶心？
症状-呕吐-症状本身,问题的例子是：有没有想吐？
症状-畏光-症状本身,问题的例子是：您的眼睛是否对光敏感？
症状-流泪-症状本身,问题的例子是：您的眼睛是否流泪增多？
症状-眼干-症状本身,问题的例子是：你有感觉眼干吗？
症状-异物感-症状本身,问题的例子是：您是否感到眼睛里有异物？
症状-异常分泌物-症状本身,问题的例子是：您的眼睛是否有大量分泌物？
症状-视物遮挡-症状本身,问题的例子是：看东西的时候是否感觉有物体遮挡视线？
症状-视力下降-症状本身,问题的例子是：你有没有看不清？
症状-视力下降-症状性质,问题的例子是：看不清是什么样子的看不清
症状-视物重影-症状本身,问题的例子是：请问您看东西有重影吗？
症状-视物变暗-症状本身,问题的例子是：请问视野会变暗吗？
症状-视物变形-症状本身,问题的例子是：你有没有视物变形？
症状-发热-症状本身,问题的例子是：你有没有发热？
既往诊疗情况-既往诊疗,问题的例子是：在发病后您是否就医过？
全身情况-精神,问题的例子是：自从发病以来，您的精神状态如何？
全身情况-胃纳,问题的例子是：自从发病以来，您的饮食状况如何？
全身情况-睡眠,问题的例子是：自从发病以来，您的睡眠状况如何？
全身情况-二便,问题的例子是：自从发病以来，您的大小便情况如何？
全身情况-体重变化,问题的例子是：自从发病以来，您的体重有没有发生变化？

[既往史]部分的缺漏为：
既往眼部病史-其他眼病,问题的例子是：在此之前，您的眼睛是否患过其他眼部疾病？
戴镜史,问题的例子是：之前有戴过眼镜吗
全身疾病史-高血压-疾病本身,问题的例子是：您之前是否有高血压的历史？
全身疾病史-高血压-发病时长,问题的例子是：您发现自己有高血压多长时间了？
全身疾病史-高血压-严重程度,问题的例子是：您最高测得的血压是多少？
全身疾病史-高血压-治疗方案,问题的例子是：您平时是否在服用降压药？
全身疾病史-高血压-治疗效果,问题的例子是：您吃降压药后血压的控制情况如何？
全身疾病史-糖尿病-疾病本身,问题的例子是：您之前是否有糖尿病的病史？
全身疾病史-冠心病-疾病本身,问题的例子是：您之前是否曾经被诊断患有冠心病？
全身疾病史-甲亢-疾病本身,问题的例子是：请问你有甲亢吗？
全身疾病史-结核-疾病本身,问题的例子是：您之前是否有结核病的病史？
全身疾病史-乙肝-疾病本身,问题的例子是：您之前是否有乙肝的病史？
全身疾病史-其他传染病-疾病本身,问题的例子是：除此之外，您之前是否还有其他传染性疾病的病史？
外伤史-外伤史,问题的例子是：在此之前，您是否有受过严重的外伤？
手术史-手术史,问题的例子是：在此之前，您是否接受过任何手术？
输血史-输血史,问题的例子是：在此之前，您是否输过血？
预防接种史-预防接种史,问题的例子是：在此之前，您是否按时接种了疫苗？

[个人史]部分的缺漏为：
接触史-粉尘,问题的例子是：您平常是否接触粉尘？
接触史-花粉,问题的例子是：您平常是否接触花粉？
接触史-放射性物质,问题的例子是：您之前是否有接触过放射线的经历？
嗜好-吸烟,问题的例子是：您平时是否有抽烟的习惯？
嗜好-喝酒,问题的例子是：您平时是否有喝酒的习惯？
嗜好-冶游史,问题的例子是：你有冶游史吗？
旅居-疫区旅居,问题的例子是：您最近是否去过受疫情影响的地区？

[家族史]部分的缺漏为：
父母,问题的例子是：您的父母身体健康如何？
遗传病,问题的例子是：在您的家族中，是否有遗传病或精神病的情况？
遗传病,问题的例子是：你父母有没有近亲结婚？

[婚育史]部分的缺漏为：
子女-是否有,问题的例子是：您是否有子女？
子女-身体情况,问题的例子是：您的孩子的身体状况如何？
配偶-身体情况,问题的例子是：您的配偶的身体状况如何？

[过敏史]部分的缺漏为：
药物,问题的例子是：在此之前，您是否有药物过敏的历史？
------------ chatZOC api called -------------------------

student_id: 123 user input: 是否还有其他症状？有无视力下降
----------------ChatZOC database log ----------------

distsnce: [0.3108527362346649, 0.3808610141277313, 0.3876468539237976] 

知识库所有match: ['眼睛有没有其他症状？', '除了目前的症状，您是否还有其他眼睛的不适感？', '您是否感到眼睛除了这些症状之外还有其他的不适？']


知识库选择: 其他没什么不舒服
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 123 user input: 有没有分泌物
----------------ChatZOC database log ----------------

distsnce: [0.4241066575050354, 0.6111907362937927, 0.6971198320388794] 

知识库所有match: ['有没有眼部分泌物？', '有没有身体其他症状', '有没有戴眼镜']


知识库选择: 没有分泌物
没有什么问题，挺健康的
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有分泌物
没有什么问题，挺健康的

#医生问题#
有没有分泌物
response: 我没有分泌物。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有分泌物
没有什么问题，挺健康的

#医生问题#
有没有分泌物

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 123 user input: 有没有明显视力下降
127.0.0.1 - - [05/Aug/2024 20:55:36] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:55:48] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:56:15] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:56:32] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:56:53] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 20:59:46] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 21:00:06] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 21:00:35] "POST /chat HTTP/1.1" 200 -
2024-08-05 21:00:46.796 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 571, in <module>
    detail_retrieval(st.session_state.state_goal,st.session_state.option)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 338, in detail_retrieval
    response_detail = info_extract_from_excel('现病史',item['问题的序号'],df)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 316, in info_extract_from_excel
    snyp_detail = '-' + row['症状细节']
TypeError: can only concatenate str (not "float") to str
127.0.0.1 - - [05/Aug/2024 23:04:57] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:05:30] "POST /chat HTTP/1.1" 200 -
----------------ChatZOC database log ----------------

distsnce: [0.29109877347946167, 0.37393438816070557, 0.5126879811286926] 

知识库所有match: ['你有没有视力下降？', '您有没有感觉到视力下降？', '有没有视物扭曲']


知识库选择: 我没有视力下降
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 123 user input: 全身有其他不适吗
----------------ChatZOC database log ----------------

distsnce: [0.5278193950653076, 0.5278193950653076, 0.668319046497345] 

知识库所有match: ['身体其他部位有不舒服吗', '身体其他部位有不舒服吗', '你的身体其他部位有不舒服吗？']


知识库选择: 没有什么问题，挺健康的
没有什么问题，挺健康的
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有什么问题，挺健康的
没有什么问题，挺健康的

#医生问题#
全身有其他不适吗
response: 我不知道。根据您提供的信息，没有提到全身其他不适的情况。如果您有任何不适，请告诉我，我会帮您记录并告知医生。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有什么问题，挺健康的
没有什么问题，挺健康的

#医生问题#
全身有其他不适吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 123 user input: 有没有发热
----------------ChatZOC database log ----------------

distsnce: [0.3008192479610443, 0.4218605160713196, 0.5817984938621521] 

知识库所有match: ['你有没有发热？', '您有没有出现发热的情况？', '你有没有发烧？']


知识库选择: 我没有发烧
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 123 user input: 有没有其他疾病
----------------ChatZOC database log ----------------

distsnce: [0.3781469464302063, 0.49625715613365173, 0.5288841724395752] 

知识库所有match: ['有没有身体其他症状', '还有没有别的传染病？', '之前有没有其他传染病？']


知识库选择: 没有什么问题，挺健康的
除了乙肝就没有其他传染病了
除了乙肝就没有其他传染病了
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有什么问题，挺健康的
除了乙肝就没有其他传染病了
除了乙肝就没有其他传染病了

#医生问题#
有没有其他疾病
response: 我没有其他疾病，除了乙肝。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有什么问题，挺健康的
除了乙肝就没有其他传染病了
除了乙肝就没有其他传染病了

#医生问题#
有没有其他疾病

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 123 user input: 乙肝什么时候诊断的？是否在抗病毒治疗
----------------ChatZOC database log ----------------

distsnce: [0.3047879934310913, 0.3576207160949707, 0.5430319905281067] 

知识库所有match: ['之前是否被诊断出患有乙肝？', '是否确诊过乙肝？', '您在过去是否有乙肝的情况？']


知识库选择: 有，我是乙肝阳性的，一直在吃药控制，现在是小三阳
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 123 user input: 在此之前，您是否接受过任何手术？
----------------ChatZOC database log ----------------

distsnce: [1.0007144039207022e-13, 0.3361111283302307, 0.35552114248275757] 

知识库所有match: ['在此之前，您是否接受过任何手术？', '您之前是否有过手术的经历？', '您是否曾经做过手术？']


知识库选择: 我没有做过手术
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 123 user input: 有无食物药物过敏
----------------ChatZOC database log ----------------

distsnce: [0.42770102620124817, 0.4543967843055725, 0.4749273359775543] 

知识库所有match: ['有对什么食物过敏吗？', '有对什么药物过敏吗？', '你之前有没有食物过敏？']


知识库选择: 没有食物过敏
我对磺胺类的药物过敏
没有食物过敏
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有食物过敏
我对磺胺类的药物过敏
没有食物过敏

#医生问题#
有无食物药物过敏
response: 我对磺胺类药物过敏，但没有食物过敏。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有食物过敏
我对磺胺类的药物过敏
没有食物过敏

#医生问题#
有无食物药物过敏

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 123 user input: 你有冶游史吗？
----------------ChatZOC database log ----------------

distsnce: [1.6392258644221114e-13, 0.6690786480903625, 0.7683358192443848] 

知识库所有match: ['你有冶游史吗？', '您有出省旅游吗？', '您之前是否有结核病的病史？']


知识库选择: 没有
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_8_麦粒肿_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id:  user input: 您好，叫什么名字？有什么不舒服
----------------ChatZOC database log ----------------

distsnce: [0.42874276638031006, 0.4385164976119995, 0.5089459419250488] 

知识库所有match: ['您叫什么名字？', '请问你有什么不舒服？', '您的名字是什么？']


知识库选择: 冯某某
我的眼皮肿了，压一下还会痛
冯某某
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
冯某某
我的眼皮肿了，压一下还会痛
冯某某

#医生问题#
您好，叫什么名字？有什么不舒服
response: 您好，我叫冯某某，我的眼皮肿了，压一下还会痛。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
冯某某
我的眼皮肿了，压一下还会痛
冯某某

#医生问题#
您好，叫什么名字？有什么不舒服

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 哪只眼？痛多久了？
----------------ChatZOC database log ----------------

distsnce: [0.14623406529426575, 0.15618695318698883, 0.1970667541027069] 

知识库所有match: 127.0.0.1 - - [05/Aug/2024 23:06:46] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:06:58] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:07:35] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:08:01] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:08:24] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:08:42] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:09:14] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:10:10] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:10:41] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:10:55] "POST /chat HTTP/1.1" 200 -
['是哪只眼睛疼/痛？', '眼睛疼/痛多久了？', '眼睛疼/痛多长时间了？']


知识库选择: 是左眼
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 痛多久了？
----------------ChatZOC database log ----------------

distsnce: [0.4024933874607086, 0.42762550711631775, 0.4539552927017212] 

知识库所有match: ['您是怎么痛的？', '眼睛疼/痛多久了？', '眼睛疼/痛多长时间了？']


知识库选择: 就是压上去的时候感觉那里会一跳一跳的痛
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
就是压上去的时候感觉那里会一跳一跳的痛
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了

#医生问题#
痛多久了？
response: 痛了三天了。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
就是压上去的时候感觉那里会一跳一跳的痛
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了
眼皮红肿还有痛都是从3天前开始的，然后昨天出现了这个白点，今天更严重了

#医生问题#
痛多久了？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 是突然出现的吗
----------------ChatZOC database log ----------------

distsnce: [0.045841850340366364, 0.5477511286735535, 0.5674611926078796] 

知识库所有match: ['是突然出现的吗？', '什么时候出现的？', '之前有出现过这样的情况吗']


知识库选择: 还挺突然的，3天前我感觉眼睛有点痛，一照镜子才发现原来是眼皮红肿了
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 有加重吗
----------------ChatZOC database log ----------------

distsnce: [0.2766020894050598, 0.4023985266685486, 0.6683915853500366] 

知识库所有match: ['有没有在加重？', '体重有没有加重呢？', '您的眼痛有加重吗？']


知识库选择: 还挺突然的，3天前我感觉眼睛有点痛，一照镜子才发现原来是眼皮红肿了
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 有加重吗？
----------------ChatZOC database log ----------------

distsnce: [0.23290599882602692, 0.35047420859336853, 0.6231253743171692] 

知识库所有match: ['有没有在加重？', '体重有没有加重呢？', '您的眼痛有加重吗？']


知识库选择: 还挺突然的，3天前我感觉眼睛有点痛，一照镜子才发现原来是眼皮红肿了
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 有越来越痛吗
----------------ChatZOC database log ----------------

distsnce: [0.43475979566574097, 0.5056454539299011, 0.5319019556045532] 

知识库所有match: ['疼痛有诱因吗', '今天有没有比昨天更痛？', '会有头痛的感觉吗？']


知识库选择: 我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
还挺突然的，3天前我感觉眼睛有点痛，一照镜子才发现原来是眼皮红肿了
我的头不疼
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
还挺突然的，3天前我感觉眼睛有点痛，一照镜子才发现原来是眼皮红肿了
我的头不疼

#医生问题#
有越来越痛吗
response: 是的，我感觉眼皮的红肿和疼痛在逐渐加剧。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我平时工作的时候会化妆，但我晚上都会卸妆的，不知道跟这个有没有关系
还挺突然的，3天前我感觉眼睛有点痛，一照镜子才发现原来是眼皮红肿了
我的头不疼

#医生问题#
有越来越痛吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 有吃什么上火的食物吗
----------------ChatZOC database log ----------------

distsnce: [0.6284626722335815, 0.7907291650772095, 0.8015223145484924] 

知识库所有match: ['有对什么食物过敏吗？', '你吃饭正常吗？', '发病以来饮食怎么样？']


知识库选择: 没有食物过敏
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有食物过敏

#医生问题#
有吃什么上火的食物吗
response: 我不知道。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有食物过敏

#医生问题#
有吃什么上火的食物吗

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 有没有吃辣椒？
prev_flag: 1 <class 'int'> <class 'int'>
------------ chatZOC api called -------------------------

student_id:  user input: 除了眼睛痛还有别的什么不舒服吗
----------------ChatZOC database log ----------------

distsnce: [0.23279371857643127, 0.23938074707984924, 0.26954859495162964] 

知识库所有match: ['眼睛还有别的不舒服吗？', '除此之外，你的眼睛还有什么不舒服吗？', '您眼睛有什么不舒服？']


知识库选择: 其他没什么不舒服
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 眼睛痒吗？
----------------ChatZOC database log ----------------

distsnce: [0.10702574253082275, 0.1773541271686554, 0.2159043401479721] 

知识库所有match: ['你的眼睛痒吗？', '您感觉到眼睛发痒吗？', '您是否感到眼睛痒痒的？']


知识库选择: 眼睛不痒
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 喜欢揉眼睛吗？
----------------ChatZOC database log ----------------

distsnce: [0.46248751878738403, 0.4917307496070862, 0.5066112875938416] 

知识库所有match: ['您是否觉得眼睛干涩？', '眼睛还有别的不舒服吗？', '眼睛痛吗？']


知识库选择: 我没有感觉眼睛干涩
其他没什么不舒服
会的，碰一下红肿的地方会痛
----------------ChatZOC database log over ----------------
new_prompt: 127.0.0.1 - - [05/Aug/2024 23:11:07] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:11:15] "POST /chat HTTP/1.1" 200 -
Number of requested results 3 is greater than number of elements in index 0, updating n_results = 0
127.0.0.1 - - [05/Aug/2024 23:11:36] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:11:36] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:12:13] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:12:37] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:12:43] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:13:12] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:13:29] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:13:58] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:14:23] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:14:41] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:14:57] "POST /chat HTTP/1.1" 200 -
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我没有感觉眼睛干涩
其他没什么不舒服
会的，碰一下红肿的地方会痛

#医生问题#
喜欢揉眼睛吗？
response: 我不喜欢揉眼睛。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我没有感觉眼睛干涩
其他没什么不舒服
会的，碰一下红肿的地方会痛

#医生问题#
喜欢揉眼睛吗？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 生活习惯好吗？
prev_flag: 1 <class 'int'> <class 'int'>
------------ chatZOC api called -------------------------

student_id:  user input: 之前眼睛还有得过什么病吗
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id:  user input: 之前有过同样情况出现吗？
----------------ChatZOC database log ----------------

distsnce: [0.14803844690322876, 0.16951555013656616, 0.18833862245082855] 

知识库所有match: ['之前有出现过这样的情况吗', '你之前出现过类似的情况吗？', '请问您之前出现过类似的情况吗？']


知识库选择: 我以前没有出现过这种突然的眼红眼痛
----------------ChatZOC database log over ----------------
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id:  user input: 你有什么家族性疾病吗
----------------ChatZOC database log ----------------

distsnce: [0.3014366924762726, 0.33709800243377686, 0.3483743965625763] 

知识库所有match: ['您的家族里是否有遗传性疾病或精神病的病例？', '家族里有得过类似的疾病吗？', '在您的家族中，是否有遗传病或精神病的情况？']


知识库选择: 没有
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 是否结婚？配偶身体如何？父母子女呢/
----------------ChatZOC database log ----------------

distsnce: [0.43674084544181824, 0.45642024278640747, 0.4757959246635437] 

知识库所有match: ['您的父母是否是近亲结婚？', '配偶身体怎么样？', '配偶身体情况怎么样？']


知识库选择: 没有，家里没有人近亲结婚
挺健康的
挺健康的
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有，家里没有人近亲结婚
挺健康的
挺健康的

#医生问题#
是否结婚？配偶身体如何？父母子女呢/
response: 我没有结婚。我不知道配偶的身体状况，因为我没有配偶。我的父母和子女身体状况我也没提及，所以他们的情况我也不清楚。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有，家里没有人近亲结婚
挺健康的
挺健康的

#医生问题#
是否结婚？配偶身体如何？父母子女呢/

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 222222 user input: 您这次主要来的症状是什么，持续时间是多长
----------------ChatZOC database log ----------------

distsnce: [0.35904258489608765, 0.386530339717865, 0.5043609738349915] 

知识库所有match: ['请问您的症状持续时间多久？', '这个症状持续了多长时间了？', '请问这个症状有多久了？']


知识库选择: 昨天开始的
昨天开始的
昨天开始的
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
昨天开始的
昨天开始的
昨天开始的

#医生问题#
您这次主要来的症状是什么，持续时间是多长
response: 我这次主要来的症状是昨天开始的，具体症状没有在信息中说明，所以我不知道持续时间是多长。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
昨天开始的
昨天开始的
昨天开始的

#医生问题#
您这次主要来的症状是什么，持续时间是多长

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 有没什么药物或者食物过敏
----------------ChatZOC database log ----------------

distsnce: [0.3494696319103241, 0.362234503030777, 0.48500359058380127] 

知识库所有match: ['有对什么药物过敏吗？', '有对什么食物过敏吗？', '你之前有没有药物过敏？']


知识库选择: 我没有药物过敏
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 222222 user input: 你怎么不舒服了
----------------ChatZOC database log ----------------

distsnce: [0.08924846351146698, 0.3604326844215393, 0.5540124177932739] 

知识库所有match: ['您怎么不舒服？', '请问你有什么不舒服？', '您是怎么痛的？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 222222 user input: 哪只眼睛
----------------ChatZOC database log ----------------

distsnce: [0.10695452988147736, 0.17614684998989105, 0.30060529708862305] 

知识库所有match: ['是哪只眼睛？', '哪边的眼睛？', '是哪只眼睛看不清？']


知识库选择: 是左眼不舒服
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 你有糖尿病高血压等全身疾病吗？
----------------ChatZOC database log ----------------

distsnce: [0.3799099326133728, 0.3822472095489502, 0.40444618463516235] 

知识库所有match: ['您之前是否有糖尿病的病史？', '是否确诊过糖尿病？', '您在过去是否有糖尿病的情况？']


知识库选择: 我没有糖尿病
我没有糖尿病
我没有糖尿病
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我没有糖尿病
我没有糖尿病
我没有糖尿病

#医生问题#
你有糖尿病高血压等全身疾病吗？
response: 我没有糖尿病。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我没有糖尿病
我没有糖尿病
我没有糖尿病

#医生问题#
你有糖尿病高血压等全身疾病吗？

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 高血压呢
----------------ChatZOC database log ----------------

distsnce: [0.33792221546173096, 0.3510240316390991, 0.36751967668533325] 

127.0.0.1 - - [05/Aug/2024 23:15:06] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:15:23] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:15:46] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [05/Aug/2024 23:15:57] "POST /chat HTTP/1.1" 200 -
2024-08-05 23:16:27.103 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 571, in <module>
    detail_retrieval(st.session_state.state_goal,st.session_state.option)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 338, in detail_retrieval
    response_detail = info_extract_from_excel('现病史',item['问题的序号'],df)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 316, in info_extract_from_excel
    snyp_detail = '-' + row['症状细节']
TypeError: can only concatenate str (not "float") to str
127.0.0.1 - - [05/Aug/2024 23:16:32] "POST /chat HTTP/1.1" 200 -
未找到文件名为 我平时工作时会化妆，但晚上都会卸妆。不确定这是否与目前的状况有关。除此之外，我没有特别注意到其他诱发.mp3 的MP3文件。
无重复
student_id : 123 output 我现在正在担心自己的眼病，请不要闲聊了
有重复
student_id : 123 output 我目前没有发现其他不舒服的症状。
未找到文件名为 我目前没有发现其他不舒服的症状。.mp3 的MP3文件。
无重复
student_id : 123 output 我没有分泌物。
未找到文件名为 我没有分泌物。.mp3 的MP3文件。
无重复
student_id : 123 output 我没有感觉到视力有明显下降。
未找到文件名为 我没有感觉到视力有明显下降。.mp3 的MP3文件。
无重复
student_id : 123 output 我不知道。根据您提供的信息，没有提到全身其他不适的情况。如果您有任何不适，请告诉我，我会帮您记录并告知医生。
未找到文件名为 我不知道。根据您提供的信息，没有提到全身其他不适的情况。如果您有任何不适，请告诉我，我会帮您记录并告.mp3 的MP3文件。
无重复
student_id : 123 output 我没有发热。
未找到文件名为 我没有发热。.mp3 的MP3文件。
无重复
student_id : 123 output 我没有其他疾病，除了乙肝。
未找到文件名为 我没有其他疾病，除了乙肝。.mp3 的MP3文件。
无重复
student_id : 123 output 我是乙肝阳性，一直在接受药物治疗，目前病情控制在了小三阳的状态。
未找到文件名为 我是乙肝阳性，一直在接受药物治疗，目前病情控制在了小三阳的状态。.mp3 的MP3文件。
无重复
student_id : 123 output 我没有接受过任何手术。
有重复
time pass: 445 <class 'int'>
student_id : 123 output 我对磺胺类药物过敏，但没有食物过敏。
未找到文件名为 我对磺胺类药物过敏，但没有食物过敏。.mp3 的MP3文件。
无重复
student_id : 123 output 我没有冶游史。 \n\n同义转述：我没有这方面的经历。
未找到文件名为 我没有冶游史。 \n\n同义转述：我没有这方面的经历。.mp3 的MP3文件。
无重复
[3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[14, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 40, 41, 42, 44, 46, 47, 48, 49, 50] <class 'list'>
14
进展
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
nan
student_id :  output 您好，我叫冯某某，我的眼皮肿了，压一下还会痛。
未找到文件名为 您好，我叫冯某某，我的眼皮肿了，压一下还会痛。.mp3 的MP3文件。
无重复
student_id :  output 我是左眼痛。
未找到文件名为 我是左眼痛。.mp3 的MP3文件。
无重复
student_id :  output 痛了三天了。
未找到文件名为 痛了三天了。.mp3 的MP3文件。
无重复
student_id :  output 是的，感觉挺突然的。三天前我开始觉得眼睛有点痛，后来照镜子才发现眼皮红肿了。
未找到文件名为 是的，感觉挺突然的。三天前我开始觉得眼睛有点痛，后来照镜子才发现眼皮红肿了。.mp3 的MP3文件。
无重复
student_id :  output 我觉得挺突然的，大概三天前开始觉得眼睛有点痛，后来照镜子才发现眼皮变得红肿了。
未找到文件名为 我觉得挺突然的，大概三天前开始觉得眼睛有点痛，后来照镜子才发现眼皮变得红肿了。.mp3 的MP3文件。
无重复
student_id :  output 我觉得挺突然的，大概三天前，我开始感到眼睛有点痛，后来照镜子才发现眼皮变得红肿了。
未找到文件名为 我觉得挺突然的，大概三天前，我开始感到眼睛有点痛，后来照镜子才发现眼皮变得红肿了。.mp3 的MP3文件。
无重复
student_id :  output 是的，我感觉眼皮的红肿和疼痛在逐渐加剧。
未找到文件名为 是的，我感觉眼皮的红肿和疼痛在逐渐加剧。.mp3 的MP3文件。
无重复
student_id :  output 我不知道。
有重复
student_id :  output 你能重复一遍吗？问详细一点
未找到文件名为 你能重复一遍吗？问详细一点.mp3 的MP3文件。
无重复
time pass: 322 <class 'int'>
student_id :  output 我目前除了眼睛痛，没有其他不适。
未找到文件名为 我目前除了眼睛痛，没有其他不适。.mp3 的MP3文件。
无重复
student_id :  output 我的眼睛不痒。
未找到文件名为 我的眼睛不痒。.mp3 的MP3文件。
无重复
student_id :  output 我不喜欢揉眼睛。
未找到文件名为 我不喜欢揉眼睛。.mp3 的MP3文件。
无重复
student_id :  output 能问详细点吗？具体是？
有重复
student_id :  output 我现在正在担心自己的眼病，请不要闲聊了
有重复
student_id :  output 我之前并未经历过这种突如其来的眼红和眼痛症状。
未找到文件名为 我之前并未经历过这种突如其来的眼红和眼痛症状。.mp3 的MP3文件。
无重复
student_id :  output 我没有家族遗传病的记录。
有重复
student_id :  output 我没有结婚。我不知道配偶的身体状况，因为我没有配偶。我的父母和子女身体状况我也没提及，所以他们的情况我也不清楚。
未找到文件名为 我没有结婚。我不知道配偶的身体状况，因为我没有配偶。我的父母和子女身体状况我也没提及，所以他们的情况.mp3 的MP3文件。
无重复
student_id : 222222 output 我这次主要来的症状是昨天开始的，具体症状没有在信息中说明，所以我不知道持续时间是多长。
未找到文件名为 我这次主要来的症状是昨天开始的，具体症状没有在信息中说明，所以我不知道持续时间是多长。.mp3 的MP3文件。
无重复
student_id :  output 我没有对任何药物产生过敏反应。
未找到文件名为 我没有对任何药物产生过敏反应。.mp3 的MP3文件。
无重复
student_id : 222222 output 我眼部突然感到疼痛，还出现了红肿，视力也变得模糊了。
有重复
student_id : 222222 output 我是左眼感觉不舒服。
有重复
student_id :  output 我没有糖尿病。
未找到文件名为 我没有糖尿病。.mp3 的MP3文件。
无重复
time pass: 609 <class 'int'>
student_id :  output 我患有高血压。
未找到文件名为 我患有高血压。.mp3 的MP3文件。
无重复
student_id : 222222 output 我没有头痛、头晕、呕吐、恶心，也没有眼红、眼痛、畏光或流泪的症状。
未找到文件名为 我没有头痛、头晕、呕吐、恶心，也没有眼红、眼痛、畏光或流泪的症状。.mp3 的MP3文件。
无重复
student_id : 222222 output 我感到眼睛对光线很敏感，动不动就会流泪。
未找到文件名为 我感到眼睛对光线很敏感，动不动就会流泪。.mp3 的MP3文件。
无重复
student_id :  output 我眼睛变得很敏感，对光线比较敏感，而且经常不由自主地流泪。
未找到文件名为 我眼睛变得很敏感，对光线比较敏感，而且经常不由自主地流泪。.mp3 的MP3文件。
无重复
[2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null
/
set null
10
set null
/
set null
[11, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 30, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
11
症状本身
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
23
症状性质
24
nan
student_id : 222222 output 你能重复一遍吗？问详细一点
有重复
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] <class 'list'>
1
set null
/
set null
2
set null
/
set null
3
set null
/
set null
4
set null
/
set null
5
set null
/
set null
6
set null
/
set null
7
set null
/
set null
8
set null
/
set null
9
set null127.0.0.1 - - [05/Aug/2024 23:23:27] "POST /load HTTP/1.1" 200 -
2024-08-05 23:24:04.889 Session with id f7be7110-08f9-4630-b98d-dc0d073f4cd1 is already connected! Connecting to a new session.
2024-08-05 23:24:07.762 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
2024-08-05 23:39:13.401 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
127.0.0.1 - - [06/Aug/2024 11:23:14] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [06/Aug/2024 11:23:31] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [06/Aug/2024 11:23:50] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [06/Aug/2024 11:24:27] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [06/Aug/2024 11:27:28] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [06/Aug/2024 11:27:34] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [06/Aug/2024 11:28:29] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [06/Aug/2024 11:28:37] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [06/Aug/2024 11:28:49] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [06/Aug/2024 11:29:30] "POST /chat HTTP/1.1" 200 -
2024-08-06 16:56:36.490 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization

/
set null
10
set null
/
set null
[14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 46, 47, 48, 49, 50] <class 'list'>
14
进展
16
/
set null
17
/
set null
18
/
set null
19
/
set null
20
/
set null
21
症状本身
22
症状本身
23
症状性质
24
/
set null
25
/
set null
26
症状本身
29
症状本身
30
症状本身
31
症状本身
32
症状本身
33
症状本身
34
症状本身
35
症状本身
36
症状本身
37
症状本身
38
症状本身
39
症状性质
40
症状本身
41
症状本身
42
症状本身
43
症状本身
44
/
set null
46
/
set null
47
/
set null
48
/
set null
49
/
set null
50
/
set null
[51, 52, 53, 54, 55, 56, 57, 58, 59, 63, 66, 67, 68, 69, 70, 71, 72, 73, 74] <class 'list'>
51
/
set null
52
/
set null
53
set null
/
set null
54
疾病本身
55
发病时长
56
严重程度
57
治疗方案
58
治疗效果
59
疾病本身
63
疾病本身
66
疾病本身
67
疾病本身
68
疾病本身
69
疾病本身
70
疾病本身
71
/
set null
72
/
set null
73
/
set null
74
/
set null
[75, 76, 77, 78, 79, 80, 81] <class 'list'>
75
/
set null
76
/
set null
77
/
set null
78
/
set null
79
/
set null
80
/
set null
81
/
set null
[82, 83, 84, 85] <class 'list'>
82
set null
/
set null
83
set null
/
set null
84
set null
/
set null
85
set null
/
set null
[86, 87, 88] <class 'list'>
86
/
set null
87
/
set null
88
/
set null
[92, 93] <class 'list'>
92
set null
/
set null
93
set null
/
set null
student_id :  output 这个问题跟我的眼病没有关系吧
未找到文件名为 这个问题跟我的眼病没有关系吧.mp3 的MP3文件。
无重复
student_id :  output 你问的具体是什么？说详细一点可以吗？
有重复
student_id :  output 我眼部突然感到疼痛，还出现了红肿，视力也变得模糊。
有重复
student_id :  output 是的，左眼不舒服。
未找到文件名为 是的，左眼不舒服。.mp3 的MP3文件。
无重复
  Stopping...

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://172.21.46.28:8502
  External URL: http://47.251.88.253:8502

 * Serving Flask app 'teaching_api_ch'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8892
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 125-435-311
127.0.0.1 - - [15/Aug/2024 15:09:37] "POST /load HTTP/1.1" 200 -
/root/miniconda3/envs/embedding/lib/python3.10/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
127.0.0.1 - - [15/Aug/2024 15:10:23] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:10:36] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:10:52] "POST /chat HTTP/1.1" 200 -
2024-08-15 15:27:07.092 Uncaught app exception
Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 411, in __getitem__
    return self._getitem(widget_id, key)
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 456, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 127, in __getattr__
    return self[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 98, in __getitem__
    return get_session_state()[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/safe_session_state.py", line 93, in __getitem__
    return self._state[key]
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state.py", line 413, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
  File "/home/to_NM/demo_NM_zh/pages/开始问诊.py", line 413, in <module>
    if st.session_state.option == 'ChatZOC':
  File "/root/miniconda3/envs/embedding/lib/python3.10/site-packages/streamlit/runtime/state/session_state_proxy.py", line 129, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "option". Did you forget to initialize it? More info: https://docs.streamlit.io/library/advanced-features/session-state#initialization
127.0.0.1 - - [15/Aug/2024 15:29:27] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:29:50] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:30:22] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:30:32] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:30:54] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:31:11] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:31:47] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:32:06] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:32:25] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [15/Aug/2024 15:33:56] "POST /load HTTP/1.1" 200 -
2024-08-15 16:24:23.254 Session with id 304f0546-df3f-408a-a2a7-aade50d8d594 is already connected! Connecting to a new session.
127.0.0.1 - - [15/Aug/2024 20:50:19] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:09:26] "POST /load HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:10:45] "POST /load HTTP/1.1" 200 -
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 1 user input: 您好！
----------------ChatZOC database log ----------------

distsnce: [0.6143130660057068, 1.0198132991790771, 1.0264619588851929] 

知识库所有match: ['你怎么了？', '绝经了吗？', '你有小孩吗？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的眼睛突然疼痛、发红，看不清东西

#医生问题#
您好！
response: 您好！医生。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我的眼睛突然疼痛、发红，看不清东西

#医生问题#
您好！

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id: 1 user input: 您好，请问您有什么不舒服
----------------ChatZOC database log ----------------

distsnce: [0.16463671624660492, 0.4604027569293976, 0.49785315990448] 

知识库所有match: ['请问你有什么不舒服？', '您怎么不舒服？', '除了刚才说的，还有别的不舒服的吗？']


知识库选择: 我的眼睛突然疼痛、发红，看不清东西
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id: 1 user input: 哪个眼睛，疼得厉害么
----------------ChatZOC database log ----------------

distsnce: [0.37128445506095886, 0.3746674954891205, 0.38738444447517395] 

知识库所有match: ['您眼睛疼痛的具体类别是怎样的？', '在眼睛疼痛时还发生了什么', '是否有眼部疼痛？']


知识库选择: 是剧烈的胀痛
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
有
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是剧烈的胀痛
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
有

#医生问题#
哪个眼睛，疼得厉害么
response: 左眼疼得厉害。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
是剧烈的胀痛
昨天我跟家里人吵架了，当时情绪有点激动，然后眼睛就开始不舒服了
有

#医生问题#
哪个眼睛，疼得厉害么

**************FINISHED*****************



../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id:  user input: 你结婚了吗
----------------ChatZOC database log ----------------

distsnce: [0.02727178856730461, 0.0709637925028801, 0.13278116285800934] 

知识库所有match: ['您结婚了吗？', '您是否结婚了？', '您是否已婚？']


知识库选择: 我已经结婚了
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 你是否有过敏史
----------------ChatZOC database log ----------------

distsnce: [0.40409281849861145, 0.4047701358795166, 0.4125071167945862] 

知识库所有match: ['您是否曾经出现过药物过敏？', '您之前是否有药物过敏的情况？', '在此之前，您是否有药物过敏的历史？']


知识库选择: 我没有药物过敏
我没有药物过敏
我没有药物过敏
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我没有药物过敏
我没有药物过敏
我没有药物过敏

#医生问题#
你是否有过敏史
response: 我没有过敏史。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
我没有药物过敏
我没有药物过敏
我没有药物过敏

#医生问题#
你是否有过敏史

**************FINISHED*****************



------------ chatZOC api called -------------------------

student_id:  user input: 既往有出现过这个情况吗
----------------ChatZOC database log ----------------

distsnce: [0.10053995996713638, 0.3554360866546631, 0.3631259799003601] 

知识库所有match: ['之前有出现过这样的情况吗', '以前有类似的情况吗？', '请问您之前出现过类似的情况吗？']


知识库选择: 我以前没有出现过这种突然的眼红眼痛
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 这种症状有多长时间了
----------------ChatZOC database log ----------------

distsnce: [0.16417786478996277, 0.22614195942878723, 0.3607536852359772] 

知识库所有match: ['这个症状持续了多长时间了？', '请问这个症状有多久了？', '这种症状是突然出现的，还是慢慢发生的']


知识库选择: 昨天开始的
----------------ChatZOC database log over ----------------
------------ chatZOC api called -------------------------

student_id:  user input: 家里人是否有过这种症状呢
----------------ChatZOC database log ----------------

distsnce: [0.3978525996208191, 0.40646791458129883, 0.4704451262950897] 

知识库所有match: ['家族里有得过类似的疾病吗？', '请问您家里人有相类似的疾病吗？', '请问这个症状有多久了？']


知识库选择: 没有
没有
昨天开始的
----------------ChatZOC database log over ----------------
new_prompt: 以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有
没有
昨天开始的

#医生问题#
家里人是否有过这种症状呢
response: 我不知道。



**************full prompt*****************
以第一人称回答，仅回答医生提问的内容，不要回答多余的内容，不要自己延伸回答的内容，如果 #患者信息# 中没有提到，则说”我不知道“

#患者信息#
没有
没有
昨天开始的

#医生问题#
家里人是否有过这种症状呢

**************FINISHED*****************



../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
../knowledge_base_new/modified_7_急性原发性闭角型青光眼_1.json
成功创建知识库
------------ chatZOC api called -------------------------

student_id: 111 user input: 哪里不舒服?
----------------ChatZOC database log ----------------

distsnce: [0.2704373300075531, 0.29444748163223267, 0.346230149269104] 

知识库所有match: 127.0.0.1 - - [18/Aug/2024 22:11:06] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:11:40] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:13:21] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:14:17] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:14:38] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:14:52] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:15:13] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:15:51] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:16:07] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:16:20] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:16:37] "POST /chat HTTP/1.1" 200 -
127.0.0.1 - - [18/Aug/2024 22:17:00] "POST /chat HTTP/1.1" 200 -
